"use strict";var l=require("../../../../common/vendor.js");const f={name:"uniFormsItem",props:{custom:{type:Boolean,default:!1},showMessage:{type:Boolean,default:!0},name:String,required:Boolean,validateTrigger:{type:String,default:""},leftIcon:String,iconColor:{type:String,default:"#606266"},label:String,labelWidth:{type:[Number,String],default:""},labelAlign:{type:String,default:""},labelPosition:{type:String,default:""},errorMessage:{type:[String,Boolean],default:""},rules:{type:Array,default(){return[]}}},data(){return{errorTop:!1,errorBottom:!1,labelMarginBottom:"",errorWidth:"",errMsg:"",val:"",labelPos:"",labelWid:"",labelAli:"",showMsg:"undertext",border:!1,isFirstBorder:!1,isArray:!1,arrayField:""}},computed:{msg(){return this.errorMessage||this.errMsg},fieldStyle(){let e={};return this.labelPos=="top"&&(e.padding="0 0",this.labelMarginBottom="6px"),this.labelPos=="left"&&this.msg!==!1&&this.msg!=""?(e.paddingBottom="0px",this.errorBottom=!0,this.errorTop=!1):this.labelPos=="top"&&this.msg!==!1&&this.msg!=""?(this.errorBottom=!1,this.errorTop=!0):(this.errorTop=!1,this.errorBottom=!1),e},justifyContent(){if(this.labelAli==="left")return"flex-start";if(this.labelAli==="center")return"center";if(this.labelAli==="right")return"flex-end"},labelLeft(){return(this.labelPos==="left"?parseInt(this.labelWid):0)+"px"}},watch:{validateTrigger(e){this.formTrigger=e}},created(){this.form=this.getForm(),this.group=this.getForm("uniGroup"),this.formRules=[],this.formTrigger=this.validateTrigger,this.name&&this.name.indexOf("[")!==-1&&this.name.indexOf("]")!==-1&&(this.isArray=!0,this.arrayField=this.name,this.form.formData[this.name]=this.form._getValue(this.name,""))},mounted(){this.form&&this.form.childrens.push(this),this.init()},unmounted(){this.__isUnmounted=!0,this.unInit()},methods:{init(){if(this.form){let{formRules:e,validator:t,formData:r,value:o,labelPosition:i,labelWidth:s,labelAlign:a,errShowType:h}=this.form;this.labelPos=this.labelPosition?this.labelPosition:i,this.label?this.labelWid=this.labelWidth?this.labelWidth:s||70:this.labelWid=this.labelWidth?this.labelWidth:s||"auto",this.labelWid&&this.labelWid!=="auto"&&(this.labelWid+="px"),this.labelAli=this.labelAlign?this.labelAlign:a,this.form.isFirstBorder||(this.form.isFirstBorder=!0,this.isFirstBorder=!0),this.group&&(this.group.isFirstBorder||(this.group.isFirstBorder=!0,this.isFirstBorder=!0)),this.border=this.form.border,this.showMsg=h;let n=this.isArray?this.arrayField:this.name;if(!n)return;e&&this.rules.length>0&&(e[n]||(e[n]={rules:this.rules}),t.updateSchema(e)),this.formRules=e[n]||{},this.validator=t}else this.labelPos=this.labelPosition||"left",this.labelWid=this.labelWidth||65,this.labelAli=this.labelAlign||"left"},unInit(){this.form&&this.form.childrens.forEach((e,t)=>{e===this&&(this.form.childrens.splice(t,1),delete this.form.formData[e.name])})},getForm(e="uniForms"){let t=this.$parent,r=t.$options.name;for(;r!==e;){if(t=t.$parent,!t)return!1;r=t.$options.name}return t},clearValidate(){this.errMsg=""},setValue(e){let t=this.isArray?this.arrayField:this.name;if(t){if(this.errMsg&&(this.errMsg=""),this.form.formData[t]=this.form._getValue(t,e),!this.formRules||typeof this.formRules&&JSON.stringify(this.formRules)==="{}")return;this.triggerCheck(this.form._getValue(this.name,e))}},async triggerCheck(e,t){if(this.errMsg="",!this.validator||Object.keys(this.formRules).length===0)return;const r=this.isRequired(this.formRules.rules||[]);let o=this.isTrigger(this.formRules.validateTrigger,this.validateTrigger,this.form.validateTrigger),i=null;if(!!o||t){let a=this.isArray?this.arrayField:this.name;i=await this.validator.validateUpdate({[a]:e},this.form.formData)}!r&&(e===void 0||e==="")&&(i=null);const s=this.form.inputChildrens.find(a=>a.rename===this.name);return(o||t)&&i&&i.errorMessage?(s&&(s.errMsg=i.errorMessage),this.form.errShowType==="toast"&&l.index.showToast({title:i.errorMessage||"\u6821\u9A8C\u9519\u8BEF",icon:"none"}),this.form.errShowType==="modal"&&l.index.showModal({title:"\u63D0\u793A",content:i.errorMessage||"\u6821\u9A8C\u9519\u8BEF"})):s&&(s.errMsg=""),this.errMsg=i?i.errorMessage:"",this.form.validateCheck(i||null),i||null},isTrigger(e,t,r){return e==="submit"||!e?e===void 0?t!=="bind"?t?!1:r==="bind":!0:!1:!0},isRequired(e){let t=!1;for(let r=0;r<e.length;r++)if(e[r].required){t=!0;break}return t}}};Array||l.resolveComponent("uni-icons")();const u=()=>"../../../uni-icons/components/uni-icons/uni-icons.js";Math||u();function m(e,t,r,o,i,s){return l.e({a:r.required},r.required?{}:{},{b:r.leftIcon},r.leftIcon?{c:l.p({size:"16",type:r.leftIcon,color:r.iconColor})}:{},{d:l.t(r.label),e:r.label},r.label?{}:{},{f:i.labelWid,g:s.justifyContent,h:s.msg?1:"",i:l.n("is-direction-"+i.labelPos),j:s.msg},s.msg?{k:l.t(i.showMsg==="undertext"?s.msg:""),l:i.border?1:"",m:s.labelLeft}:{},{n:i.border?1:"",o:i.border&&i.isFirstBorder?1:"",p:s.msg?1:""})}var d=l._export_sfc(f,[["render",m],["__file","C:/myself/social/social/src/uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.vue"]]);wx.createComponent(d);
//# sourceMappingURL=uni-forms-item.js.map
