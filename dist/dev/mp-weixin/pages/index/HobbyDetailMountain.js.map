{"version":3,"file":"HobbyDetailMountain.js","sources":["../../../../../src/pages/index/HobbyDetailMountain.vue","../../../../../uniPage:/cGFnZXMvaW5kZXgvSG9iYnlEZXRhaWxNb3VudGFpbi52dWU"],"sourcesContent":["<!--\r\n * @Author: Aiden(戴林波)\r\n * @Date: 2022-02-25 14:59:08\r\n * @LastEditTime: 2022-04-15 16:59:35\r\n * @LastEditors: Aiden(戴林波)\r\n * @Description: \r\n * @Email: jason_dlb@sina.cn\r\n-->\r\n<template>\r\n  <div class=\"hobby-detail\">\r\n    <view class=\"swiper-box\" v-if=\"hobbyInfo.fileType === 0\">\r\n      <swiper class=\"swiper-box\" :indicator-dots=\"hobbyInfo.photos.length > 1\">\r\n        <swiper-item v-for=\"(item, index) in hobbyInfo.photos\" :key=\"index\">\r\n          <view class=\"swiper-item\">\r\n            <image :src=\"item\" class=\"image\" mode=\"aspectFit\"></image>\r\n          </view>\r\n        </swiper-item>\r\n      </swiper>\r\n    </view>\r\n    <view class=\"swiper-box\" v-if=\"hobbyInfo.fileType === 1\">\r\n      <view class=\"swiper-item\">\r\n      <VideoPlayer :options=\"{src: hobbyInfo.video_url, poster: hobbyInfo.url}\" :key=\"hobbyInfo.id\"></VideoPlayer>\r\n      </view>\r\n    </view>\r\n    <view class=\"author-wraper\">\r\n      <view class=\"author\">\r\n        <view class=\"author-info\">\r\n          <image\r\n            class=\"avatar\"\r\n            mode=\"aspectFit\"\r\n            :src=\"hobbyInfo.avatar || ''\"\r\n          ></image>\r\n          <text>{{ hobbyInfo.username || \"\" }}</text>\r\n        </view>\r\n        <view\r\n          :class=\"{ follow: !isFlollow, active: isFlollow }\"\r\n          @click=\"following\"\r\n        >\r\n          <text>{{ followText }}</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <view class=\"content-wraper\">\r\n      <view class=\"content\">\r\n        <view class=\"title\">\r\n          {{ hobbyInfo.title }}\r\n        </view>\r\n        <view class=\"main\">\r\n          {{ hobbyInfo.content }}\r\n        </view>\r\n        <view class=\"publish-date\"\r\n          ><text>发布于: </text><text>{{ publishDate }}</text></view\r\n        >\r\n      </view>\r\n    </view>\r\n    <view class=\"comment-wraper\">\r\n      <Comment v-if=\"hobbyInfo.id\" :hobbyInfo=\"hobbyInfo\" :key=\"hobbyInfo.id\"/>\r\n    </view>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, onMounted, computed } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\n\r\nimport { getHobbyDetail } from \"@/api/hobby.js\";\r\nimport { setFollow, getFollow, deleteFollow } from \"@/api/communication.js\";\r\nimport Comment from \"@/pages/components/Comment.vue\";\r\nimport VideoPlayer from \"@/pages/components/VideoPlayer.vue\";\r\n\r\nimport { formatDate } from \"@/utils/util.js\";\r\n\r\nexport default {\r\n  components: {\r\n    Comment,\r\n    VideoPlayer\r\n  },\r\n  onLoad: function(options) {\r\n    console.log(\"options===\", options);\r\n  },\r\n  onReady: function(){\r\n\r\n  },\r\n  setup(props) {\r\n    console.log('props=', props)\r\n    const store = useStore();\r\n    const userInfo = computed(() => store.state.user.userInfo).value;\r\n\r\n   const options = reactive({\r\n      poster: '',\r\n      src: \"\", //视频源\r\n    });\r\n\r\n    let info = ref([\r\n      {\r\n        content:\r\n          \"https://social-1308251497.cos.ap-guangzhou.myqcloud.com/images/4.jfif\",\r\n      },\r\n    ]);\r\n\r\n    let hobbyInfo = ref({});\r\n    const initGetHobbyDetail = (obj) => {\r\n      const { id, hobby } = obj\r\n      const params = { id, hobby };\r\n      getHobbyDetail(params).then((data) => {\r\n        console.log(\"data===\", data);\r\n        if (data.data.code === 200) {\r\n          hobbyInfo.value = data.data.data;\r\n          publishDate.value = formatDate(data.data.data.create_time);\r\n          console.log('hobbyInfo.value===', hobbyInfo.value)\r\n          console.log('data.data.data.url===', data.data.data.url)\r\n          options.poster = data.data.data.url\r\n          options.src = data.data.data.video_url\r\n          initFlow();\r\n        }\r\n      });\r\n    };\r\n\r\n    // 关注\r\n    let isFlollow = ref(false);\r\n    let followText = ref(\"关注\");\r\n    const following = () => {\r\n      if (isFlollow.value) {\r\n        uni.showModal({\r\n          content: \"确认不再关注？\",\r\n          success: function(res) {\r\n            if (res.confirm) {\r\n              let params = { followId: hobbyInfo.value.user_id };\r\n              deleteFollow(params).then((data) => {\r\n                if (data.data.code === 200) {\r\n                  followText.value = \"关注\";\r\n                  isFlollow.value = false;\r\n                }\r\n              });\r\n            } else if (res.cancel) {\r\n              console.log(\"用户点击取消\");\r\n            }\r\n          },\r\n        });\r\n        return;\r\n      }\r\n      console.log(\"userInfo===\", userInfo);\r\n      let params = { followId: hobbyInfo.value.user_id };\r\n      setFollow(params).then((data) => {\r\n        console.log(\"data===\", data);\r\n        if (data.data.code === 200) {\r\n          followText.value = \"已关注\";\r\n          isFlollow.value = true;\r\n        } else if(data.data.code === 400) {\r\n          uni.showToast({\r\n            title: data.data.msg,\r\n            icon: 'none',\r\n            duration: 2000\r\n          })\r\n        }\r\n      });\r\n    };\r\n\r\n    // 发布\r\n    let publishDate = ref(null);\r\n\r\n    const initFlow = () => {\r\n      let params = { followId: hobbyInfo.value.user_id };\r\n      console.log(\"params===\", params);\r\n      getFollow(params).then((data) => {\r\n        console.log(\"data1===\", data);\r\n        if (data.data.code === 200) {\r\n          isFlollow.value = data.data.isFollow;\r\n          data.data.isFollow\r\n            ? (followText.value = \"已关注\")\r\n            : (followText.value = \"关注\");\r\n        }\r\n      });\r\n    };\r\n\r\n    // 导航标题\r\n    const onNavTitle = (obj) => {\r\n      console.log('obj===================================================================================', obj)\r\n              const { hobby } = obj\r\n const strateies = {\r\n     'hobby2': () => uni.setNavigationBarTitle({\r\n    title: '狼人杀'\r\n  }),\r\n     'hobby3': () => uni.setNavigationBarTitle({\r\n    title: '剧本杀'\r\n  }),\r\n     'hobby4': () => uni.setNavigationBarTitle({\r\n    title: '登山'\r\n  }),\r\n     'hobby5': () => uni.setNavigationBarTitle({\r\n    title: '旅游'\r\n  }),\r\n     'hobby6': () => uni.setNavigationBarTitle({\r\n    title: '视频'\r\n  }),\r\n     'hobby7': () => uni.setNavigationBarTitle({\r\n    title: '电影'\r\n  })\r\n }\r\n strateies[`hobby${hobby}`]()\r\n\r\n    }\r\n\r\n    onMounted(() => {\r\n      console.log(\"userInfo===\", userInfo);\r\n      onNavTitle(props)\r\n      initGetHobbyDetail({id: props.id, hobby: props.hobby});\r\n    });\r\n    return {\r\n      followText,\r\n      isFlollow,\r\n      following,\r\n      hobbyInfo,\r\n      info,\r\n      publishDate,\r\n      options\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.hobby-detail {\r\n}\r\n.swiper-box {\r\n  width: 100%;\r\n  height: 554rpx;\r\n  .swiper-item {\r\n    width: 100%;\r\n    height: 100%;\r\n    .image {\r\n      width: inherit;\r\n      height: 100%;\r\n    }\r\n  }\r\n}\r\n\r\n.author-wraper {\r\n  margin-top: 32rpx;\r\n  padding: 0 32rpx;\r\n}\r\n.author {\r\n  padding-bottom: 32rpx;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  border-bottom: 1px solid #e6e6e6;\r\n  .author-info {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .avatar {\r\n    width: 52rpx;\r\n    height: 52rpx;\r\n    border-radius: 50%;\r\n    background-color: #ccc;\r\n    margin-right: 20rpx;\r\n  }\r\n  .follow {\r\n    border: 1rpx solid #ff2442;\r\n    border-radius: 8rpx;\r\n    color: #ff2442;\r\n    padding: 10rpx 20rpx;\r\n    font-size: 24rpx;\r\n  }\r\n  .active {\r\n    border: 1rpx solid #ccc;\r\n    border-radius: 8rpx;\r\n    color: #ccc;\r\n    padding: 10rpx 20rpx;\r\n    font-size: 24rpx;\r\n  }\r\n}\r\n.content-wraper {\r\n  margin-top: 32rpx;\r\n  padding: 0 32rpx;\r\n  .content {\r\n    padding-bottom: 32rpx;\r\n    border-bottom: 1px solid #e6e6e6;\r\n    .title {\r\n      font-size: 32rpx;\r\n      font-weight: 700;\r\n    }\r\n    .main {\r\n      margin-top: 20rpx;\r\n      color: #555;\r\n      letter-spacing: 6rpx;\r\n      text-indent: 2em;\r\n    }\r\n    .publish-date {\r\n      margin-top: 20rpx;\r\n      color: #999;\r\n      font-size: 24rpx;\r\n    }\r\n  }\r\n}\r\n.comment-wraper {\r\n  margin-top: 32rpx;\r\n  padding: 0 32rpx;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/myself/social/social/src/pages/index/HobbyDetailMountain.vue'\nwx.createPage(MiniProgramPage)"],"names":["useStore","computed","reactive","ref","getHobbyDetail","formatDate","uni","deleteFollow","setFollow","getFollow","onMounted"],"mappings":"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"}