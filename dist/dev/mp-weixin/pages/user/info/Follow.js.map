{"version":3,"file":"Follow.js","sources":["../../../../../../src/pages/user/info/Follow.vue","../../../../../../uniPage:/cGFnZXMvdXNlci9pbmZvL0ZvbGxvdy52dWU"],"sourcesContent":["<template>\r\n  <view class=\"info-list\">\r\n    <view class=\"ul\">\r\n      <view class=\"li\" v-for=\"item in infoList\" :key=\"item.id\" @click=\"goUserDetail(item)\">\r\n       <view class=\"userinfo-wraper\">\r\n        <view class=\"avatar-wraper\">\r\n          <image\r\n            class=\"avatar\"\r\n            mode=\"aspectFit\"\r\n            :src=\"item.avatar || ''\"\r\n          ></image>\r\n        </view>\r\n        <view class=\"publish-info\">\r\n          <view class=\"title\">{{ item.title }} </view>\r\n          <view class=\"userinfo\">\r\n            <text class=\"username\">{{ item.username }}</text>\r\n          </view>\r\n          <view class=\"userinfo\">\r\n            <text class=\"username\">{{ item.motto }}</text>\r\n          </view>\r\n        </view>\r\n       </view>\r\n       <view\r\n          :class=\"{ follow: !isFlollow, active: isFlollow }\"\r\n          @click.stop=\"following(item)\"\r\n        >\r\n          <text>{{ followText }}</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, watch } from \"vue\";\r\nimport { getFollowsInfo, getFansInfo } from \"@/api/communication.js\";\r\nimport { setFollow, getFollow, deleteFollow } from \"@/api/communication.js\";\r\nexport default {\r\n  name: \"follow\",\r\n  setup(props) {\r\n    let infoList = ref([]);\r\n\r\n        // 关注\r\n    let isFlollow = ref(false);\r\n    let followText = ref(\"关注\");\r\n    const following = (info) => {\r\n      if (isFlollow.value) {\r\n        uni.showModal({\r\n          content: \"确认不再关注？\",\r\n          success: function(res) {\r\n            if (res.confirm) {\r\n              let params = { followId: info.user_id };\r\n              deleteFollow(params).then((data) => {\r\n                if (data.data.code === 200) {\r\n                  followText.value = \"关注\";\r\n                  isFlollow.value = false;\r\n                  getInfo(JSON.parse(decodeURIComponent(props.userids)));\r\n                }\r\n              });\r\n            } else if (res.cancel) {\r\n              console.log(\"用户点击取消\");\r\n            }\r\n          },\r\n        });\r\n        return;\r\n      }\r\n      let params = { followId: info.user_id };\r\n      setFollow(params).then((data) => {\r\n        console.log(\"data===\", data);\r\n        if (data.data.code === 200) {\r\n          followText.value = \"已关注\";\r\n          isFlollow.value = true;\r\n        } else if(data.data.code === 400) {\r\n          uni.showToast({\r\n            title: data.data.msg,\r\n            icon: 'none',\r\n            duration: 2000\r\n          })\r\n        }\r\n      });\r\n    };\r\n\r\n    const initFlow = (info) => {\r\n      let params = { followId: info.user_id };\r\n      console.log(\"params===\", params);\r\n      getFollow(params).then((data) => {\r\n        console.log(\"data1===\", data);\r\n        if (data.data.code === 200) {\r\n          isFlollow.value = data.data.isFollow;\r\n          data.data.isFollow\r\n            ? (followText.value = \"已关注\")\r\n            : (followText.value = \"关注\");\r\n        }\r\n      });\r\n    };\r\n\r\n    const getInfo = (userids) => {\r\n      const params = {\r\n        userids,\r\n      };\r\n      if (parseInt(props.type) === 0) {\r\n        uni.setNavigationBarTitle({\r\n          title: \"关注\",\r\n        }),\r\n          getFollowsInfo(params).then((data) => {\r\n            if (data.data.code === 200) {\r\n              infoList.value = data.data.followsInfo;\r\n              infoList.value = infoList.value.filter((element) => element);\r\n              console.log(\"infoList.value====\", infoList.value);\r\n              infoList.value.forEach((item) => {\r\n                initFlow(item)\r\n              })\r\n            }\r\n          });\r\n      } else if (parseInt(props.type) === 1) {\r\n        uni.setNavigationBarTitle({\r\n          title: \"粉丝\",\r\n        }),\r\n          getFansInfo(params).then((data) => {\r\n            console.log(\"getFansInfo===\", data);\r\n            if (data.data.code === 200) {\r\n              infoList.value = data.data.fansInfo;\r\n              infoList.value = infoList.value.filter((element) => element);\r\n              infoList.value.forEach((item) => {\r\n                initFlow(item)\r\n              })\r\n            }\r\n          });\r\n      }\r\n    };\r\n\r\n    // 跳转到好友详情\r\n    const goUserDetail = (info) => {\r\n      console.log('info======', info)\r\n          uni.navigateTo({\r\n    url: `/pages/user/info/User?id=${info.user_id}`,\r\n  });\r\n    }\r\n\r\n    onMounted(() => {\r\n      //   console.log(\"props=\", JSON.parse(decodeURIComponent(props.userids)));\r\n      getInfo(JSON.parse(decodeURIComponent(props.userids)));\r\n      // console.log(\"infoList.value=\", infoList.value);\r\n    });\r\n    return {\r\n      infoList,\r\n      followText,\r\n      isFlollow,\r\n      following,\r\n      goUserDetail\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.li {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 20rpx;\r\n  border-bottom: 1rpx solid #ccc;\r\n  .userinfo-wraper{\r\n    display: flex;\r\n  }\r\n  .avatar-wraper {\r\n    width: 100rpx;\r\n    height: 100rpx;\r\n    .avatar {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n  .img {\r\n    margin-left: 20rpx;\r\n    width: 133rpx;\r\n    height: 100rpx;\r\n    .img-url {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n}\r\n.publish-info {\r\n  margin-left: 40rpx;\r\n  .title {\r\n    font-size: 36rpx;\r\n    font-weight: 600;\r\n    color: #363636;\r\n  }\r\n}\r\n\r\n  .follow {\r\n    border: 1rpx solid #ff2442;\r\n    border-radius: 8rpx;\r\n    color: #ff2442;\r\n    padding: 10rpx 20rpx;\r\n    font-size: 24rpx;\r\n  }\r\n  .active {\r\n    border: 1rpx solid #ccc;\r\n    border-radius: 8rpx;\r\n    color: #ccc;\r\n    padding: 10rpx 10rpx;\r\n    font-size: 24rpx;\r\n  }\r\n\r\n.userinfo {\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 24rpx;\r\n  color: #363636;\r\n  .avatar {\r\n    width: 50rpx;\r\n    height: 50rpx;\r\n    border-radius: 10rpx;\r\n  }\r\n  .username,\r\n  .update-time {\r\n    margin-left: 30rpx;\r\n  }\r\n}\r\n.replay-icon {\r\n  width: 1.2rem;\r\n  height: 1.2rem;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/myself/social/social/src/pages/user/info/Follow.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","deleteFollow","setFollow","getFollow","getFollowsInfo","getFansInfo","onMounted"],"mappings":"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"}