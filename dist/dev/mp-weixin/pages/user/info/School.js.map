{"version":3,"file":"School.js","sources":["../../../../../../src/pages/user/info/School.vue","../../../../../../uniPage:/cGFnZXMvdXNlci9pbmZvL1NjaG9vbC52dWU"],"sourcesContent":["<!--\r\n * @Author: Aiden(戴林波)\r\n * @Date: 2021-12-29 14:06:11\r\n * @LastEditTime: 2022-01-05 16:11:37\r\n * @LastEditors: Aiden(戴林波)\r\n * @Description: \r\n * @Email: jason_dlb@sina.cn\r\n-->\r\n<template>\r\n  <div class=\"school\">\r\n    <uni-search-bar placeholder=\"请输入学校名称\" @confirm=\"search\" v-model=\"schoolName\"></uni-search-bar>\r\n    <uni-list v-if=\"schools.length\">\r\n      <uni-list-item\r\n        v-for=\"item in schools\"\r\n        :key=\"item.code\"\r\n        :title=\"item.name\"\r\n        :clickable=\"true\"\r\n        @click=\"onChecked(item)\"\r\n        style=\"text-align: center\"\r\n      ></uni-list-item>\r\n      <uni-list-item\r\n        v-if=\"isShowMore\"\r\n        :clickable=\"true\"\r\n        title=\"加载更多...\"\r\n        style=\"text-align: center\"\r\n        @click=\"onLoadMore\"\r\n      ></uni-list-item>\r\n    </uni-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"school\",\r\n};\r\n</script>\r\n\r\n<script setup>\r\nimport { ref, reactive } from \"vue\";\r\nimport { getSchool } from \"../../../api/user\";\r\n\r\nlet schools = ref([]);\r\nlet pageNum = ref(1)\r\nlet queryString = ref('')\r\nlet schoolName = ref('')\r\nlet isShowMore = ref(false)\r\n\r\nconst searchSchool = (query, page) => {\r\n    const params = {\r\n    name: query,\r\n    page: String(page),\r\n  }\r\n  getSchool(params).then((data) => {\r\n    console.log(\"data===\", data);\r\n    schools.value = [...schools.value, ...data.data.data];\r\n    console.log('schools.value=====', schools.value)\r\n    isShowMore.value = true\r\n    if(data.data.data.length < 10){\r\n      isShowMore.value = false\r\n    }\r\n    if(page === 1 && schools.value.length === 0){\r\n      schools.value = [{name: '其他学校'}]\r\n    }\r\n    console.log('schools=', schools)\r\n  })\r\n}\r\n\r\nconst search = (e) => {\r\n  console.log(\"e===\", e);\r\n  const { value } = e;\r\n  queryString.value = value\r\n  schools.value = []\r\n  searchSchool(value, 1)\r\n};\r\nconst onLoadMore = () => {\r\n  pageNum.value++\r\n  console.log('pageNum.value===', pageNum.value)\r\n  searchSchool(queryString.value, pageNum.value)\r\n\r\n}\r\nconst onChecked = (item) => {\r\n  schoolName.value = item.name\r\n  schools.value = []\r\n  uni.$emit('schoolUpdate',{schoolName:schoolName.value})\r\n  uni.navigateBack()\r\n//     uni.navigateTo({\r\n//     url: `/pages/user/info/Editor?schoolName=${schoolName.value}`\r\n// });\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>","import MiniProgramPage from 'C:/myself/social/social/src/pages/user/info/School.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","getSchool","uni"],"mappings":"8iBAgCA,QAAe,CACb,KAAM,QACR,8BAOA,GAAI,GAAUA,MAAI,EAAE,EAChB,EAAUA,MAAI,CAAC,EACf,EAAcA,MAAI,EAAE,EACpB,EAAaA,MAAI,EAAE,EACnB,EAAaA,MAAI,EAAK,EAE1B,KAAM,GAAe,CAAC,EAAO,IAAS,CAClC,KAAM,GAAS,CACf,KAAM,EACN,KAAM,OAAO,CAAI,GAEnBC,YAAU,CAAM,EAAE,KAAK,AAAC,GAAS,CAC/B,QAAQ,IAAI,UAAW,CAAI,EAC3B,EAAQ,MAAQ,CAAC,GAAG,EAAQ,MAAO,GAAG,EAAK,KAAK,IAAI,EACpD,QAAQ,IAAI,qBAAsB,EAAQ,KAAK,EAC/C,EAAW,MAAQ,GAChB,EAAK,KAAK,KAAK,OAAS,IACzB,GAAW,MAAQ,IAElB,IAAS,GAAK,EAAQ,MAAM,SAAW,GACxC,GAAQ,MAAQ,CAAC,CAAC,KAAM,0BAAM,CAAC,GAEjC,QAAQ,IAAI,WAAY,CAAO,EAChC,CACH,EAEM,EAAS,AAAC,GAAM,CACpB,QAAQ,IAAI,OAAQ,CAAC,EACrB,KAAM,CAAE,SAAU,EAClB,EAAY,MAAQ,EACpB,EAAQ,MAAQ,GAChB,EAAa,EAAO,CAAC,CACvB,EACM,EAAa,IAAM,CACvB,EAAQ,QACR,QAAQ,IAAI,mBAAoB,EAAQ,KAAK,EAC7C,EAAa,EAAY,MAAO,EAAQ,KAAK,CAE/C,EACM,EAAY,AAAC,GAAS,CAC1B,EAAW,MAAQ,EAAK,KACxB,EAAQ,MAAQ,GAChBC,QAAI,MAAM,eAAe,CAAC,WAAW,EAAW,KAAK,CAAC,EACtDA,QAAI,cAIN,mhBCvFA,GAAG,WAAW,CAAe"}