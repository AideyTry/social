{"version":3,"file":"index.js","sources":["../../../../../../../src/pagesUser/pages/user/info/index.vue","../../../../../../../uniPage:/cGFnZXNVc2VyXHBhZ2VzXHVzZXJcaW5mb1xpbmRleC52dWU"],"sourcesContent":["<!--\r\n * @Author: Aiden(戴林波)\r\n * @Date: 2021-12-22 16:09:06\r\n * @LastEditTime: 2021-12-31 18:29:18\r\n * @LastEditors: Aiden(戴林波)\r\n * @Description: \r\n * @Email: jason_dlb@sina.cn\r\n-->\r\n<template>\r\n  <view class=\"userinfo-wraper\">\r\n    <view class=\"userinfo\">\r\n      <image\r\n        mode=\"aspectFill\"\r\n        :src=\"avatar ? avatar : defaultAvatar\"\r\n        class=\"avatar\"\r\n      ></image>\r\n      <text class=\"basic-info\">\r\n        {{ userInfo.location }}/{{ userInfo.gender }}/{{ age }}\r\n      </text>\r\n    </view>\r\n    <view class=\"photos\">\r\n      <view\r\n        class=\"photo-wraper\"\r\n        @click=\"onUpload(item, index)\"\r\n        v-for=\"(item, index) in images\"\r\n        :key=\"index\"\r\n      >\r\n        <image mode=\"aspectFill\" :src=\"item ? item : defaultAvatar\" class=\"photo\"></image>\r\n        <text\r\n          class=\"photo-add\"\r\n          v-if=\"(!item && images[index - 1]) || (index === 0 && !images[0])\"\r\n          >+</text\r\n        >\r\n      </view>\r\n    </view>\r\n    <button @click=\"editor\">编辑资料</button>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed, ref, reactive } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nconst defaultAvatar = \"/static/images/default_avatar.png\";\r\nconst store = useStore();\r\nlet userInfo = computed(() => store.state.user.userInfo).value;\r\n\r\nlet images = reactive(userInfo.photos);\r\n\r\n\r\nconsole.log('images===', images)\r\n\r\nconst avatar = ref(userInfo.avatar)\r\n// if (!userInfo.photos) {\r\n//   for(let i = 0; i<5; i++){\r\n//     images.push('')\r\n//   }\r\n// }\r\n\r\n/**\r\n * @description: 提交图片\r\n * @param {*}\r\n * @Author: \r\n * @return {*}\r\n */\r\nconst onUploadFile = (filePath) => {\r\n      uni.uploadFile({\r\n        url: \"http://127.0.0.1:3000/users/uploadFile\",\r\n        filePath,\r\n        name: \"file\",\r\n        formData: {\r\n          user: \"test\",\r\n        },\r\n        success: (uploadFileRes) => {\r\n          console.log(\"uploadFileRes===\", uploadFileRes);\r\n        },\r\n      });\r\n}\r\n\r\n/**\r\n * @description: 头像上传\r\n * @param {*}\r\n * @Author:\r\n * @return {*}\r\n */\r\nconst onUpload = (item, index) => {\r\n  console.log('item, index===', item, index)\r\n  if(item){\r\n    uni.previewImage({\r\n            urls: images,\r\n            longPressActions: {\r\n                itemList: ['发送给朋友', '保存图片', '收藏'],\r\n                success: function(data) {\r\n                    console.log('选中了第' + (data.tapIndex + 1) + '个按钮,第' + (data.index + 1) + '张图片');\r\n                },\r\n                fail: function(err) {\r\n                    console.log(err.errMsg);\r\n                }\r\n            }\r\n        });\r\n        return\r\n  }\r\n    uni.navigateTo({\r\n    url: '/pages/user/info/Editor'\r\n});\r\n\r\nlet age = ref('')\r\nconst getDate = (type) => {\r\n  const date = new Date();\r\n  let year = date.getFullYear();\r\n  let month = date.getMonth() + 1;\r\n  let day = date.getDate();\r\n\r\n  if (type === \"start\") {\r\n    year = year - 60;\r\n  } else if (type === \"end\") {\r\n    year = year + 2;\r\n  }\r\n  month = month > 9 ? month : \"0\" + month;\r\n  day = day > 9 ? day : \"0\" + day;\r\n  return `${year}-${month}-${day}`;\r\n};\r\n\r\nconst currentDate = getDate({\r\n  format: true,\r\n});\r\n\r\n// 编辑资料\r\nconst editor = () => {}\r\n\r\n  // uni.chooseImage({\r\n  //   success: (chooseImageRes) => {\r\n  //     console.log(\"chooseImageRes===\", chooseImageRes);\r\n  //     const { tempFilePaths, tempFiles } = chooseImageRes;\r\n  //     console.log(\"tempFilePaths[0]===\", tempFilePaths[0]);\r\n  //     // onUploadFile(tempFilePaths[0])\r\n  //     images[index] = tempFilePaths[0]\r\n  //     console.log('images===', images)\r\n  //   },\r\n  // });\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.userinfo-wraper {\r\n  padding: 40rpx;\r\n}\r\n.userinfo {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n.avatar {\r\n  width: 150rpx;\r\n  height: 150rpx;\r\n  border-radius: 50%;\r\n}\r\n.photos {\r\n  display: flex;\r\n  .photo-wraper {\r\n    position: relative;\r\n    margin-right: 20rpx;\r\n    .photo {\r\n      width: 100rpx;\r\n      height: 100rpx;\r\n      border-radius: 20%;\r\n    }\r\n    .photo-add {\r\n      position: absolute;\r\n      left: 50%;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n      font-size: 12rpx;\r\n    }\r\n  }\r\n}\r\n</style>","import MiniProgramPage from 'C:/myself/social/social/src/pagesUser/pages/user/info/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["useStore","computed","reactive","ref","uni"],"mappings":"6EA0CA,KAAM,GAAgB,oCAChB,EAAQA,aACd,GAAI,GAAWC,aAAS,IAAM,EAAM,MAAM,KAAK,QAAQ,EAAE,MAErD,EAASC,WAAS,EAAS,MAAM,EAGrC,QAAQ,IAAI,YAAa,CAAM,EAE/B,KAAM,GAASC,MAAI,EAAS,MAAM,EAiC5B,EAAW,CAAC,EAAM,IAAU,CAEhC,GADA,QAAQ,IAAI,iBAAkB,EAAM,CAAK,EACtC,EAAK,CACNC,QAAI,aAAa,CACT,KAAM,EACN,iBAAkB,CACd,SAAU,CAAC,iCAAS,2BAAQ,cAAI,EAChC,QAAS,SAAS,EAAM,CACpB,QAAQ,IAAI,2BAAU,GAAK,SAAW,GAAK,4BAAW,GAAK,MAAQ,GAAK,oBAAK,GAEjF,KAAM,SAAS,EAAK,CAChB,QAAQ,IAAI,EAAI,MAAM,IAGjC,EACD,OAEJA,QAAI,WAAW,CACf,IAAK,yBACT,CAAC,EAESD,MAAI,EAAE,EAiBI,AAhBJ,CAAC,GAAS,CACxB,KAAM,GAAO,GAAI,MACjB,GAAI,GAAO,EAAK,cACZ,EAAQ,EAAK,WAAa,EAC1B,EAAM,EAAK,UAEf,MAAI,KAAS,QACX,EAAO,EAAO,GACL,IAAS,OAClB,GAAO,EAAO,GAEhB,EAAQ,EAAQ,EAAI,EAAQ,IAAM,EAClC,EAAM,EAAM,EAAI,EAAM,IAAM,EACrB,GAAG,KAAQ,KAAS,GAC7B,GAE4B,CAC1B,OAAQ,EACV,CAAC,CAeD,0bC1IA,GAAG,WAAW,CAAe"}