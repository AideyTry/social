{"version":3,"file":"Comment.a8535f5c.js","sources":["../../../../src/pages/components/Comment.vue"],"sourcesContent":["<!--\r\n * @Author: Aiden(戴林波)\r\n * @Date: 2022-02-28 14:49:16\r\n * @LastEditTime: 2022-04-10 16:12:13\r\n * @LastEditors: Aiden(戴林波)\r\n * @Description: \r\n * @Email: jason_dlb@sina.cn\r\n-->\r\n<template>\r\n  <div class=\"comment\">\r\n    <view class=\"total\"\r\n      ><text>共</text><text>{{ total }}</text\r\n      ><text>条评论</text></view\r\n    >\r\n    <view class=\"my-comment\">\r\n      <image\r\n        class=\"avatar\"\r\n        mode=\"aspectFit\"\r\n        :src=\"hobbyInfo.avatar || ''\"\r\n      ></image>\r\n      <input\r\n        v-model=\"inputString\"\r\n        type=\"text\"\r\n        class=\"comment-input\"\r\n        placeholder=\"喜欢就给个评论支持一下呗~\"\r\n        @confirm=\"confirm\"\r\n      />\r\n    </view>\r\n    <view class=\"other-comment\" v-for=\"item in comments\" :key=\"item.id\">\r\n      <view>\r\n        <image\r\n          class=\"avatar\"\r\n          mode=\"aspectFit\"\r\n          :src=\"item.avatar || ''\"\r\n        ></image>\r\n      </view>\r\n      <view class=\"comment-info\">\r\n        <view class=\"userinfo\"><text>{{item.username}}</text><text v-if=\"item.isAuthor\" class=\"is-author\">作者</text></view>\r\n        <view class=\"comment-content\"\r\n          ><text\r\n            >{{item.comment}}</text\r\n          ></view>\r\n          <view>\r\n              <text>{{$filters.commentTime(item.create_time)}}</text>\r\n          </view>\r\n      </view>\r\n    </view>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"comment\",\r\n};\r\n</script>\r\n<script setup>\r\nimport { setComment, getComment } from \"@/api/communication.js\";\r\nimport { ref, nextTick, onMounted } from \"vue\";\r\nconst props = defineProps({\r\n  hobbyInfo: {\r\n    type: Object,\r\n    default: {},\r\n  },\r\n});\r\nlet inputString = ref('')\r\nlet total = ref(0)\r\nlet comments = ref([])\r\nconsole.log(\"props=\", props);\r\n\r\nconst confirm = (e) => {\r\n    console.log('e=', e)\r\n    const { detail: { value } } = e\r\n    let params = {\r\n        comment: value,\r\n        detailUserId: props.hobbyInfo.user_id,\r\n        hobbyId: props.hobbyInfo[`hobby_${props.hobbyInfo.hobby}_id`],\r\n        hobby: props.hobbyInfo.hobby\r\n    }\r\n    setComment(params).then(data => {\r\n        if(data.statusCode === 200){\r\n          inputString.value = ''\r\n            getCommentData()\r\n        }\r\n    })\r\n}\r\n\r\nconst getCommentData = () => {\r\n  console.log('props.hobbyInfo=======================', props.hobbyInfo)\r\n    let params = {\r\n        hobbyId: props.hobbyInfo[`hobby_${props.hobbyInfo.hobby}_id`],\r\n        hobby: props.hobbyInfo.hobby\r\n    }\r\n    getComment(params).then(data => {\r\n            console.log('data666666===', data)\r\n            if(data.data.code === 200){\r\n                comments.value = data.data.data\r\n                total.value= data.data.data.length\r\n            }\r\n        })\r\n}\r\n\r\nonMounted(() => {\r\n  nextTick(() => {\r\n    getCommentData()\r\n  })\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.comment {\r\n  .total {\r\n    font-size: 28rpx;\r\n  }\r\n  .my-comment {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 60rpx;\r\n    padding: 20rpx 0;\r\n  }\r\n  .avatar {\r\n    width: 52rpx;\r\n    height: 52rpx;\r\n    border-radius: 50%;\r\n    background-color: #fdfdfd;\r\n    margin-right: 15rpx;\r\n  }\r\n  .comment-input {\r\n    margin-left: 20rpx;\r\n    width: calc(100vw - 124rpx);\r\n    height: 100%;\r\n    background: #ddd;\r\n    border-radius: 40rpx;\r\n  }\r\n  .other-comment {\r\n    display: flex;\r\n    font-size: 28rpx;\r\n    padding-bottom: 10rpx;\r\n    border-bottom: 1rpx solid #ccc;\r\n    .comment-info {\r\n      color: #363636;\r\n      & > view{\r\n          margin-bottom: 10rpx;\r\n      }\r\n      .is-author{\r\n          display: inline-block;\r\n          margin-left: 10rpx;\r\n          background-color: #dfdfdf;\r\n          font-size: 24rpx;\r\n          border-radius: 10rpx;\r\n          color: #888;\r\n      }\r\n      .userinfo {\r\n        color: #ddd;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"names":["name","inputString","ref","total","comments","log","props","confirm","e","detail","value","params","comment","detailUserId","hobbyInfo","user_id","hobbyId","hobby","then","data","statusCode","getCommentData","code","length"],"mappings":"4RAmDA,QAAe,CACbA,KAAM,sGAYJC,EAAcC,EAAI,IAClBC,EAAQD,EAAI,GACZE,EAAWF,EAAI,YACXG,IAAI,SAAUC,SAEhBC,EAAWC,YACLH,IAAI,KAAMG,SACVC,QAAQC,MAAEA,IAAYF,MAC1BG,EAAS,CACTC,QAASF,EACTG,aAAcP,EAAMQ,UAAUC,QAC9BC,QAASV,EAAMQ,UAAU,SAASR,EAAMQ,UAAUG,YAClDA,MAAOX,EAAMQ,UAAUG,SAEhBN,GAAQO,UACQ,MAApBC,EAAKC,eACMV,MAAQ,YAMxBW,EAAiB,aACbhB,IAAI,yCAA0CC,EAAMQ,eACtDH,EAAS,CACTK,QAASV,EAAMQ,UAAU,SAASR,EAAMQ,UAAUG,YAClDA,MAAOX,EAAMQ,UAAUG,SAEhBN,GAAQO,kBACHb,IAAI,gBAAiBc,GACP,MAAnBA,EAAKA,KAAKG,SACAZ,MAAQS,EAAKA,KAAKA,OACrBT,MAAOS,EAAKA,KAAKA,KAAKI,sBAKlC,QACC"}