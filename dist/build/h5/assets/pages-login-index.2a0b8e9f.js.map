{"version":3,"file":"pages-login-index.2a0b8e9f.js","sources":["../../../../src/uni_modules/uni-link/components/uni-link/uni-link.vue","../../../../src/pages/login/index.vue","../../../../src/static/logo.png"],"sourcesContent":["<template>\r\n\t<a v-if=\"isShowA\" class=\"uni-link\" :href=\"href\"\r\n\t\t:class=\"{'uni-link--withline':showUnderLine===true||showUnderLine==='true'}\"\r\n\t\t:style=\"{color,fontSize:fontSize+'px'}\" :download=\"download\">\r\n\t\t<slot>{{text}}</slot>\r\n\t</a>\r\n\t<!-- #ifndef APP-NVUE -->\r\n\t<text v-else class=\"uni-link\" :class=\"{'uni-link--withline':showUnderLine===true||showUnderLine==='true'}\"\r\n\t\t:style=\"{color,fontSize:fontSize+'px'}\" @click=\"openURL\">\r\n\t\t<slot>{{text}}</slot>\r\n\t</text>\r\n\t<!-- #endif -->\r\n\t<!-- #ifdef APP-NVUE -->\r\n\t<text v-else class=\"uni-link\" :class=\"{'uni-link--withline':showUnderLine===true||showUnderLine==='true'}\"\r\n\t\t:style=\"{color,fontSize:fontSize+'px'}\" @click=\"openURL\">\r\n\t\t{{text}}\r\n\t</text>\r\n\t<!-- #endif -->\r\n</template>\r\n\r\n<script>\r\n\t/**\r\n\t * Link 外部网页超链接组件\r\n\t * @description uni-link是一个外部网页超链接组件，在小程序内复制url，在app内打开外部浏览器，在h5端打开新网页\r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?id=1182\r\n\t * @property {String} href 点击后打开的外部网页url\r\n\t * @property {String} text 显示的文字\r\n\t * @property {String} downlaod H5平台下载文件名\r\n\t * @property {Boolean} showUnderLine 是否显示下划线\r\n\t * @property {String} copyTips 在小程序端复制链接时显示的提示语\r\n\t * @property {String} color 链接文字颜色\r\n\t * @property {String} fontSize 链接文字大小\r\n\t * @example * <uni-link href=\"https://ext.dcloud.net.cn\" text=\"https://ext.dcloud.net.cn\"></uni-link>\r\n\t */\r\n\texport default {\r\n\t\tname: 'uniLink',\r\n\t\tprops: {\r\n\t\t\thref: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\ttext: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\tdownload: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\tshowUnderLine: {\r\n\t\t\t\ttype: [Boolean, String],\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\tcopyTips: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '已自动复制网址，请在手机浏览器里粘贴该网址'\r\n\t\t\t},\r\n\t\t\tcolor: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '#999999'\r\n\t\t\t},\r\n\t\t\tfontSize: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 14\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tisShowA() {\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\tthis._isH5 = true;\r\n\t\t\t\t// #endif\r\n\t\t\t\tif ((this.isMail() || this.isTel()) && this._isH5 === true) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis._isH5 = null;\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tisMail() {\r\n\t\t\t\treturn this.href.startsWith('mailto:');\r\n\t\t\t},\r\n\t\t\tisTel() {\r\n\t\t\t\treturn this.href.startsWith('tel:');\r\n\t\t\t},\r\n\t\t\topenURL() {\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tif (this.isTel()) {\r\n\t\t\t\t\tthis.makePhoneCall(this.href.replace('tel:', ''));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplus.runtime.openURL(this.href);\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\twindow.open(this.href)\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef MP\r\n\t\t\t\tuni.setClipboardData({\r\n\t\t\t\t\tdata: this.href\r\n\t\t\t\t});\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\tcontent: this.copyTips,\r\n\t\t\t\t\tshowCancel: false\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tmakePhoneCall(phoneNumber) {\r\n\t\t\t\tuni.makePhoneCall({\r\n\t\t\t\t\tphoneNumber\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t/* #ifndef APP-NVUE */\r\n\t.uni-link {\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t/* #endif */\r\n\t.uni-link--withline {\r\n\t\ttext-decoration: underline;\r\n\t}\r\n</style>\r\n","<template>\r\n  <view class=\"login-wraper\">\r\n    <view class=\"image-wraper\">\r\n      <!-- <image\r\n        style=\"width: 100%; height: 100%\"\r\n        src=\"../../static/images/login-bg.gif\"\r\n        mode=\"\"\r\n      ></image> -->\r\n      <image\r\n      class=\"image\"\r\n      src=\"../../static/logo.png\"></image>\r\n      <text class=\"logo-title\">蔓草兴趣</text>\r\n    </view>\r\n    <view class=\"login\">\r\n      <!-- #ifdef H5 || APP-PLUS -->\r\n      <form @submit=\"formSubmit\" @reset=\"formReset\" class=\"login-in\">\r\n        <view class=\"row-flex uni-form-item uni-column\">\r\n          <text class=\"title\">手机号：</text>\r\n          <input\r\n            class=\"uni-input\"\r\n            name=\"phone\"\r\n            placeholder=\"请输入手机号\"\r\n            @input=\"onInput\"\r\n          />\r\n        </view>\r\n        <view class=\"row-flex uni-form-item uni-column\">\r\n          <text class=\"title\">验证码：</text>\r\n          <input\r\n            class=\"uni-input\"\r\n            name=\"code\"\r\n            placeholder=\"请输入验证码\"\r\n            @input=\"onInputCode\"\r\n          />\r\n          <button\r\n            class=\"code\"\r\n            :disabled=\"(!sendCaptchaEnabled || codeVisible)\"\r\n            @click=\"sendCaptcha\"\r\n          >\r\n            {{ codeMessage\r\n            }}<text v-if=\"!sendCaptchaEnabled\">({{ counterTimer }}s)</text>\r\n          </button>\r\n        </view>\r\n        <view class=\"uni-btn-v\">\r\n          <button\r\n            form-type=\"submit\"\r\n            type=\"primary\"\r\n            class=\"btn-block\"\r\n            :disabled=\"loginVisible\"\r\n          >\r\n            登录\r\n          </button>\r\n        </view>\r\n      </form>\r\n      <!-- #endif -->\r\n      <!-- #ifdef APP-PLUS -->\r\n      <view class=\"cut-off-line row\">\r\n        <view class=\"col-8 line-left\"></view>\r\n        <text>其他登录方式</text>\r\n        <view class=\"col-8 line-right\"></view>\r\n      </view>\r\n      <view class=\"other-login\">\r\n        <button\r\n          @click=\"wechatLogin\"\r\n          withCredentials=\"true\"\r\n          class=\"login-way wechat\"\r\n        >\r\n          <view class=\"m-icon m-icon-weixin\"></view>\r\n        </button>\r\n        <!-- </view> -->\r\n        <button\r\n          @click=\"qqLogin\"\r\n          withCredentials=\"true\"\r\n          class=\"login-way wechat\"\r\n        >\r\n          <view class=\"m-icon m-icon-QQ\"></view>\r\n        </button>\r\n        <button\r\n          @click=\"weiboLogin\"\r\n          withCredentials=\"true\"\r\n          class=\"login-way wechat\"\r\n        >\r\n          <view class=\"m-icon m-icon-weibo\"></view>\r\n        </button>\r\n      </view>\r\n      <!-- #endif -->\r\n    </view>\r\n\r\n    <!-- #ifdef MP-WEIXIN -->\r\n    <button\r\n      type=\"primary\"\r\n      open-type=\"openSetting\"\r\n      @getuserinfo=\"miniProLogin\"\r\n      class=\"auth-btn\"\r\n    >\r\n      登录\r\n    </button>\r\n    <button\r\n      type=\"primary\"\r\n      open-type=\"getUserInfo\"\r\n      @getuserinfo=\"getInfo\"\r\n      class=\"auth-btn\"\r\n    >\r\n      登录授权\r\n    </button>\r\n\r\n    <!-- #endif -->\r\n    <view class=\"gov-wraper\"><uni-link class=\"gov\" :showUnderLine=\"false\" href=\"https://beian.miit.gov.cn/\" text=\"粤ICP备2021179573号\"></uni-link></view>\r\n  </view>\r\n</template>\r\n<script>\r\nimport { sendCode, codePhoneLogin } from \"../../api/user.js\";\r\nimport { setToken } from \"../../utils/auth.js\";\r\n\r\n/*  #ifdef  MP-WEIXIN  */\r\nimport { loginWechat } from \"../../api/wechat\";\r\n/*  #endif  */\r\nexport default {\r\n  data() {\r\n    return {\r\n      codeVisible: true,\r\n      loginVisible: true,\r\n      sendCaptchaEnabled: true,\r\n      codeMessage: \"获取验证码\",\r\n      counterTimer: 60,\r\n      phoneNumber: null,\r\n    };\r\n  },\r\n  methods: {\r\n    onInput: function(e) {\r\n      console.log(\"input e=\", e);\r\n      if (/^1[3456789]\\d{9}$/.test(e.detail.value)) {\r\n        this.codeVisible = false;\r\n        this.phoneNumber = e.detail.value;\r\n      } else {\r\n        this.codeVisible = true;\r\n      }\r\n    },\r\n    onInputCode: function(e) {\r\n      console.log(\"code=\", e);\r\n      if (/^\\d{6}$/.test(e.detail.value)) {\r\n        this.loginVisible = false;\r\n      } else {\r\n        this.loginVisible = true;\r\n      }\r\n    },\r\n    sendCaptcha: function(e) {\r\n      console.log(\"button e=\", e);\r\n      if (!this.sendCaptchaEnabled) {\r\n        return;\r\n      }\r\n      this.sendCaptchaEnabled = false;\r\n      const params = {\r\n        phone: this.phoneNumber,\r\n      };\r\n      console.log(\"params===\", params);\r\n      sendCode(params).then((res) => {\r\n        console.log(\"res=\", res);\r\n      });\r\n      this.codeMessage = \"重新发送\";\r\n      const timer = setInterval(() => {\r\n        if (this.counterTimer <= 0) {\r\n          this.counterTimer = 60;\r\n          this.sendCaptchaEnabled = true;\r\n          clearInterval(timer);\r\n          this.codeMessage = \"获取验证码\";\r\n          return;\r\n        }\r\n        this.counterTimer--;\r\n      }, 1000);\r\n    },\r\n    formSubmit: function(e) {\r\n      console.log(\"e=\", e);\r\n      console.log(\r\n        \"form发生了submit事件，携带数据为：\" + JSON.stringify(e.detail.value)\r\n      );\r\n      const params = e.detail.value;\r\n      const that = this;\r\n      console.log(\"window.navigator=\", window.navigator.userAgent);\r\n      window.navigator.__defineGetter__(\"userAgent\", () => \"myBroser\");\r\n      setTimeout(() => {\r\n        console.log(\"window.navigator1=\", window.navigator.userAgent);\r\n      }, 200);\r\n      codePhoneLogin(params).then((res) => {\r\n        console.log(\"res========\", res);\r\n        const { code, token } = res.data;\r\n        if (code === 200) {\r\n          console.log(\"成功\");\r\n          setToken(token);\r\n          that.$store.dispatch(\"user/GetUserInfo\");\r\n          uni.reLaunch({\r\n            url: \"/pages/index/index\",\r\n          });\r\n        }\r\n      });\r\n    },\r\n    miniProLogin: function(e) {\r\n      console.log(\"e===\", e);\r\n      uni.login({\r\n        provider: \"weixin\",\r\n        success: function(loginRes) {\r\n          console.log(\"loginRes=\", loginRes.authResult);\r\n        },\r\n      });\r\n    },\r\n    wechatLogin: function() {\r\n      uni.showToast({\r\n        title: \"待上线\",\r\n        duration: 2000,\r\n      });\r\n    },\r\n    qqLogin: function() {\r\n      uni.showToast({\r\n        title: \"待上线\",\r\n        duration: 2000,\r\n      });\r\n    },\r\n    weiboLogin: function() {\r\n      uni.showToast({\r\n        title: \"待上线\",\r\n        duration: 2000,\r\n      });\r\n    },\r\n    getInfo: function(e) {\r\n      console.log(\"登录e=\", e);\r\n      uni.login({\r\n        provider: \"weixin\",\r\n        success: function(loginRes) {\r\n          console.log(\"loginRes====\", loginRes);\r\n          const { code } = loginRes;\r\n          loginWechat({\r\n            code,\r\n          }).then(\"res===\", res);\r\n        },\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import url(\"../../static/iconfont/iconfont-mc/iconfont.css\");\r\n.login-wraper{\r\n  background-color: #fdfdfd;\r\n  position: relative;\r\n  height: 100vh;\r\n}\r\n.btn-block {\r\n  height: 46px;\r\n  line-height: 46px;\r\n}\r\n.image-wraper{\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 100rpx 0;\r\n.image {\r\n  height: 180rpx;\r\n  width: 180rpx;\r\n  border-radius: 100%;\r\n}\r\n.logo-title{\r\n  margin-top: 6rpx;\r\n  font-size: 56rpx;\r\n  font-family: \"Times New Roman\", Times, serif;\r\n  color: #434343;\r\n  font-weight: 500;\r\n}\r\n}\r\n\r\n.login {\r\n  padding: 20rpx;\r\n}\r\n\r\n.login-in {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n.uni-form-item .title {\r\n  padding: 40rpx 0;\r\n  font-size: 32rpx;\r\n}\r\n\r\n.code {\r\n  width: 208rpx;\r\n  font-size: 24rpx;\r\n  height: 68rpx;\r\n  line-height: 68rpx;\r\n}\r\nuni-button::after{\r\n  border: none!important;\r\n}\r\n\r\n.uni-btn-v {\r\n  margin-top: 40rpx;\r\n}\r\n\r\n.cut-off-line {\r\n  padding: 60upx 0;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.line-left {\r\n  border: 2upx solid #3f536e;\r\n}\r\n\r\n.line-right {\r\n  border: 2upx solid #3f536e;\r\n}\r\n\r\n.other-login {\r\n  /* padding-top: 40upx; */\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.wechat,\r\n.qq {\r\n  margin-right: 100rpx;\r\n}\r\n\r\n.login-way {\r\n  width: 100rpx;\r\n  height: 100rpx;\r\n  border-radius: 50%;\r\n  padding-left: 0;\r\n  background-color: #ededed;\r\n}\r\n\r\n.login-icon {\r\n  width: 100rpx;\r\n  height: 100rpx;\r\n}\r\n.m-icon {\r\n  width: 50px;\r\n  height: 50px;\r\n}\r\n\r\n.auth-btn {\r\n  margin-top: 60rpx;\r\n}\r\n.gov-wraper{\r\n  position: absolute;\r\n  bottom: 100rpx;\r\n  width: 100%;\r\n}\r\n.gov{\r\n  display: flex;\r\n  justify-content: center;\r\n  width: 100%;\r\n  }\r\n</style>\r\n","export default \"__VITE_ASSET__8ed403c9__\""],"names":["name","props","href","type","String","default","text","download","showUnderLine","Boolean","copyTips","color","fontSize","Number","computed","isShowA","_isH5","isMail","this","isTel","created","methods","startsWith","openURL","open","makePhoneCall","phoneNumber","key","class","style","_normalizeStyle","data","codeVisible","loginVisible","sendCaptchaEnabled","codeMessage","counterTimer","onInput","e","log","test","detail","value","onInputCode","sendCaptcha","params","phone","then","res2","timer","setInterval","formSubmit","JSON","stringify","that","window","navigator","userAgent","__defineGetter__","code","token","$store","dispatch","url","miniProLogin","provider","success","loginRes","authResult","wechatLogin","title","duration","qqLogin","weiboLogin","getInfo","res","_createCommentVNode","onSubmit","onReset","placeholder","disabled","_component_button"],"mappings":"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"}