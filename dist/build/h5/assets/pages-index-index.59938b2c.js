import{r as e,o as a,a as l,w as t,b as s,c as o,d as i,e as n,f as c,n as d,g as u,u as r,h as v,i as g,t as f,j as p,F as h,k as m,s as b,l as y,m as k,p as _,q as x,v as w,x as S,y as I,z,S as N,A as C,B as T,C as F,D as j,E as M,G as $,H as D}from"./index.5db6d7a1.js";import{_ as O}from"./uni-icons.eb5ebe58.js";import{r as W}from"./uni-app.es.737f45e5.js";import{_ as A,a as E}from"./uni-list.8213a1bd.js";import{g as q,a as B}from"./hobby.99fba805.js";import{s as H,g as L}from"./communication.2a2ffb84.js";import{_ as V}from"./plugin-vue_export-helper.21dcd24c.js";const G={name:"waterFall"};var K=V(Object.assign(G,{props:{list:{type:Array,default:[]},activeIndex:{type:Number,default:1}},setup(x){const w=x;let S=e([]),I=e(328),z=e(2),N=e(20),C=e(20),T=e([]),F=e(null),j=e(null);const M=()=>{T.value=new Array(z.value);for(let e=0;e<T.value.length;e++)T.value[e]=0;$()},$=async()=>{for(let e=0;e<w.list.length;e++){let a=new Image;a.src=w.list[e].url,console.log("waterfall==",j.value);const l=await new Promise((l=>{a.onload=t=>{console.log("e=",t);let s={};s.height=I.value/a.width*a.height+160,s.id=w.list[e].id,s.src=w.list[e].url,s.title=w.list[e].title,s.avatar=w.list[e].avatar,s.username=w.list[e].username,s.likes=w.list[e].likes,s.fileType=w.list[e].fileType,S.value.push(s),D(s),l(s)}}));W(),console.log("img==",l)}},D=e=>{const a=Math.min.apply(null,T.value);let l=T.value.indexOf(a);e.top=T.value[l],e.left=l*(N.value+I.value),T.value[l]+=e.height+C.value,console.log("imageData==",e)},O=e=>{console.log("item=",e);let a=m("like")||[];if(a.includes(e.id)){console.log("isOK=",a);for(let l=0;l<a.length;l++)a[l]===e.id&&a.splice(l,1);e.likes-=1,e.likeFlag=!1,b("like",a)}else e.likes+=1,e.likeFlag=!0,console.log("likeIds=",a),a.unshift(e.id),b("like",a);const l={hobby:w.activeIndex,hobbyId:e.id};H(l).then((e=>{console.log("like data=",e)}))},W=()=>{const e={hobby:w.activeIndex};L(e).then((e=>{if(console.log("getLike=",e),200===e.data.code){const a=e.data.likes.map((e=>e.hobby_id));b("like",a);for(let e=0;e<S.value.length;e++)a.includes(S.value[e].id)?S.value[e].likeFlag=!0:S.value[e].likeFlag=!1;console.log("waterfallList====",S.value)}}))};return a((()=>{console.log("list1=",w.list),M()})),l((()=>{console.log("list2=",w.list)})),t((()=>{M()})),(e,a)=>{const l=y,t=k,m=_;return s(),o(t,{class:"waterfall"},{default:i((()=>[(s(!0),n(h,null,c(r(S),(e=>(s(),o(t,{class:"waterfall-item",style:d({top:e.top+"rpx",left:e.left+"rpx"}),key:e.id,onClick:a=>(e=>{console.log("item=",e),console.log("props===",w),uni.navigateTo({url:`/pages/index/HobbyDetailMountain?id=${e.id}&hobby=${w.activeIndex}`})})(e)},{default:i((()=>[u(t,{class:"waterfall-image-wrapper"},{default:i((()=>[u(l,{class:"waterfall-image",mode:"widthFix",style:d({width:r(I)+"rpx"}),src:e.src},null,8,["style","src"]),v(' <svg class="video-icon" v-if="item.fileType" aria-hidden="true">\r\n        <use xlink:href="#icon-videofill"></use>\r\n      </svg> '),e.fileType?(s(),n("span",{key:0,class:"iconfont video-icon"},"")):v("v-if",!0)])),_:2},1024),u(t,{class:"hobby-title",ref_for:!0,ref_key:"hobbyTitle",ref:F},{default:i((()=>[g(f(e.title),1)])),_:2},1536),u(t,{class:"hobby-info"},{default:i((()=>[u(t,{class:"info"},{default:i((()=>[u(l,{class:"avatar",mode:"aspectFit",src:e.avatar},null,8,["src"]),u(m,null,{default:i((()=>[g(f(e.username),1)])),_:2},1024)])),_:2},1024),u(t,null,{default:i((()=>[v(' <svg v-if="item.likeFlag" class="icon" aria-hidden="true" @click.stop="like(item)">\r\n            <use xlink:href="#icon-xihuan1"></use>\r\n          </svg>\r\n          <svg v-else class="icon" aria-hidden="true" @click.stop="like(item)">\r\n            <use xlink:href="#icon-xihuan"></use>\r\n          </svg> '),e.likeFlag?(s(),n("span",{key:0,style:{color:"#f00"},class:"iconfont",onClick:p((a=>O(e)),["stop"])},"",8,["onClick"])):(s(),n("span",{key:1,class:"iconfont",onClick:p((a=>O(e)),["stop"])},"",8,["onClick"])),u(m,{style:{"margin-left":"10rpx"}},{default:i((()=>[g(f(e.likes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128))])),_:1})}}}),[["__scopeId","data-v-2fd3e692"]]);const P={name:"McTabs",mounted(){console.log("this===",this)}};var J=V(Object.assign(P,{setup(l){x((e=>({"656f5d51":r($)})));const t=e([{title:"英语",content:[]},{title:"狼人杀",content:[]},{title:"剧本杀",content:[]},{title:"登山",content:[]},{title:"旅游",content:[]},{title:"视频",content:[]}]);let p=e(0),m=e(0);const b=w([]),F={hobby0:e=>G(e),hobby1:e=>Z(e),hobby2:e=>le(e),hobby3:e=>U(e),hobby4:e=>oe(e),hobby5:e=>ce(e)},j=e=>{console.log("e=",e);const{detail:{current:a}}=e;console.log("current=",a)},M=e=>{const{detail:{current:a}}=e;p.value=a,m.value=b[p.value].width,F[`hobby${a}`]({pageNum:1,pageSize:100}),console.log("e=",e),console.log("navItemWidth.value=====",m.value)};a((()=>{const e=document.querySelectorAll(".nav-item");e.length>0&&(e.forEach((e=>{console.log("width=",e.offsetWidth),b.push({width:e.offsetWidth})})),m.value=b[p.value].width,console.log("items===",e),console.log("navItemWidth===",m.value),G({pageNum:1,pageSize:10}))}));const $=S((()=>`${m.value}rpx`));let D=e([]),H=e(1),L=e(10),V=e(0);var G=({pageNum:e=1,pageSize:a=10})=>{q({pageNum:e,pageSize:a}).then((e=>{console.log("data===",e),200===e.data.code&&(D.value=D.value.concat(e.data.data),V.value=e.data.total)}))};const P=e=>{if(0===p.value){if(Math.ceil(V.value/L.value)<=H.value)return;H.value++,G({pageNum:H.value,pageSize:L.value})}},J=e=>{console.log("item===",e),uni.navigateTo({url:`/pages/index/VideoDetail?id=${e.id}`})};let Q=e([]),R=e(0);const U=({pageNum:e=1,pageSize:a=10})=>{const l={pageNum:e,pageSize:a,hobby:4};console.log("hobby"),B(l).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),Q.value=e.data.data,R.value=e.data.total)}))};let X=e([]),Y=e(0);const Z=({pageNum:e=1,pageSize:a=10})=>{const l={pageNum:e,pageSize:a,hobby:2};console.log("hobby"),B(l).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),X.value=e.data.data,Y.value=e.data.total)}))};let ee=e([]),ae=e(0);const le=({pageNum:e=1,pageSize:a=10})=>{const l={pageNum:e,pageSize:a,hobby:3};console.log("hobby"),B(l).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),ee.value=e.data.data,ae.value=e.data.total)}))};let te=e([]),se=e(0);const oe=({pageNum:e=1,pageSize:a=10})=>{const l={pageNum:e,pageSize:a,hobby:5};console.log("hobby"),B(l).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),te.value=e.data.data,se.value=e.data.total)}))};let ie=e([]),ne=e(0);const ce=({pageNum:e=1,pageSize:a=10})=>{const l={pageNum:e,pageSize:a,hobby:6};console.log("hobby"),B(l).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),ie.value=e.data.data,ne.value=e.data.total)}))};return(e,a)=>{const l=_,b=k,x=N,w=y,S=W(I("uni-icons"),O),F=W(I("uni-list-item"),A),$=W(I("uni-list"),E),q=C,B=T;return s(),o(b,{class:"tabs"},{default:i((()=>[u(x,{"scroll-x":"","scroll-with-animaiton":"","enable-flex":!0,onScroll:j,class:"nav-wraper"},{default:i((()=>[u(b,{class:"nav"},{default:i((()=>[(s(!0),n(h,null,c(t.value,((e,a)=>(s(),o(b,{class:z(["nav-item",r(p)==a?"nav-item-act":""]),key:a,onClick:e=>(e=>{console.log("swiperIndex========================",e),p.value=e})(a)},{default:i((()=>[u(l,null,{default:i((()=>[g(f(e.title),1)])),_:2},1024),r(p)==a?(s(),o(b,{key:0,class:"nav-line",style:d(`{width: ${r(m)}rpx}`)},null,8,["style"])):v("v-if",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),u(B,{current:r(p),duration:300,class:"swiper",onChange:M},{default:i((()=>[(s(!0),n(h,null,c(t.value,((e,a)=>(s(),o(q,{key:a},{default:i((()=>[u(x,{"scroll-y":"true",class:"swiper-scroll",onScrolltolower:P},{default:i((()=>[0===a?(s(),o($,{key:0},{default:i((()=>[(s(!0),n(h,null,c(r(D),(e=>(s(),o(F,{title:e.title,ellipsis:e.title,note:e.description,key:e.id,direction:"column",class:"content-item"},{header:i((()=>[u(b,{class:"uni-thumb uni-content list-picture"},{default:i((()=>[e.img?(s(),o(w,{key:0,class:"slot-image",src:e.img,mode:"widthFix",onClick:a=>J(e)},null,8,["src","onClick"])):v("v-if",!0),e.hintTitle||e.dateSrc?(s(),o(b,{key:1,class:"hint"},{default:i((()=>[v(' <text v-if="item.hintTitle">By</text> '),e.hintTitle?(s(),o(l,{key:0,class:"hint-title"},{default:i((()=>[g(f(e.hintTitle),1)])),_:2},1024)):v("v-if",!0),u(l,{class:"hint-date"},{default:i((()=>[g(f(e.dateSrc),1)])),_:2},1024)])),_:2},1024)):v("v-if",!0)])),_:2},1024)])),body:i((()=>[u(b,{class:"content-body"},{default:i((()=>[u(b,{class:"title-wraper",onClick:a=>J(e)},{default:i((()=>[u(l,{class:"title"},{default:i((()=>[g(f(e.title),1)])),_:2},1024),u(b,{class:"video"},{default:i((()=>[u(S,{style:{"vertical-align":"middle"},type:"videocam",size:"20",color:"#999"}),u(l,null,{default:i((()=>[g("VIDEO")])),_:1})])),_:1})])),_:2},1032,["onClick"]),u(b,{class:"description"},{default:i((()=>[g(f(e.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["title","ellipsis","note"])))),128))])),_:2},1024)):v("v-if",!0),v(' <view v-else-if="index === 3"> '),1===a?(s(),o(K,{key:1,list:r(X),activeIndex:2},null,8,["list"])):2===a?(s(),o(K,{key:2,list:r(ee),activeIndex:3},null,8,["list"])):3===a?(s(),o(K,{key:3,list:r(Q),activeIndex:4},null,8,["list"])):4===a?(s(),o(K,{key:4,list:r(te),activeIndex:5},null,8,["list"])):5===a?(s(),o(K,{key:5,list:r(ie),activeIndex:6},null,8,["list"])):v("v-if",!0),v(' <WaterFall v-else-if="index === 6" :list="movies" :activeIndex="7"/> '),v(" </view> "),v(" <view v-else>待上线</view> ")])),_:2},1024),v(" <slot></slot> ")])),_:2},1024)))),128))])),_:1},8,["current"])])),_:1})}}}),[["__scopeId","data-v-cb851388"]]);var Q=V({onShow:function(){F()>0?j({index:2,text:"···"}):M({index:2})},components:{McTabs:J},setup(){const e=$();return S((()=>e.state.user.userInfo)).value,a((()=>{})),{title:"蔓草"}}},[["render",function(e,a,l,t,n,c){const d=D("McTabs"),r=k;return s(),o(r,{class:"content"},{default:i((()=>[u(d),v(' <button @click="open">打开弹窗</button> ')])),_:1})}],["__scopeId","data-v-5562d664"]]);export{Q as default};
//# sourceMappingURL=pages-index-index.59938b2c.js.map
