import{z as e,A as a,B as t,C as l,o,c as s,w as i,D as n,E as c,F as d,e as u,G as r,H as g,I as v,J as f,K as p,L as h,M as m,N as b,g as y,f as k,O as _,P as x,Q as w,R as I,S,T as z,U as N,V as C,W as T,X as F,Y as j,Z as D,_ as O}from"./vendor.99a7c6c2.js";import{r as M,s as W}from"./index.820bb8c9.js";import{_ as $}from"./uni-icons.e12d4142.js";import{r as A}from"./uni-app.es.4451f765.js";import{_ as L,a as P}from"./uni-list.66e090c7.js";import{g as E,a as V}from"./hobby.568df93f.js";import{s as B,g as H}from"./communication.2d8a9001.js";import{_ as K}from"./plugin-vue_export-helper.21dcd24c.js";const R={name:"waterFall"};var q=K(Object.assign(R,{props:{list:{type:Array,default:[]},activeIndex:{type:Number,default:1}},setup(I){const S=I;let z=e([]),N=e(328),C=e(2),T=e(20),F=e(20),j=e([]),D=e(null),O=e(null);const M=()=>{j.value=new Array(C.value);for(let e=0;e<j.value.length;e++)j.value[e]=0;W()},W=async()=>{for(let e=0;e<S.list.length;e++){let a=new Image;a.src=S.list[e].url,console.log("waterfall==",O.value);const t=await new Promise((t=>{a.onload=l=>{console.log("e=",l);let o={};o.height=N.value/a.width*a.height+160,o.id=S.list[e].id,o.src=S.list[e].url,o.title=S.list[e].title,o.avatar=S.list[e].avatar,o.username=S.list[e].username,o.likes=S.list[e].likes,o.fileType=S.list[e].fileType,z.value.push(o),$(o),t(o)}}));L(),console.log("img==",t)}},$=e=>{const a=Math.min.apply(null,j.value);let t=j.value.indexOf(a);e.top=j.value[t],e.left=t*(T.value+N.value),j.value[t]+=e.height+F.value,console.log("imageData==",e)},A=e=>{console.log("item=",e);let a=y("like")||[];if(a.includes(e.id)){console.log("isOK=",a);for(let t=0;t<a.length;t++)a[t]===e.id&&a.splice(t,1);e.likes-=1,e.likeFlag=!1,k("like",a)}else e.likes+=1,e.likeFlag=!0,console.log("likeIds=",a),a.unshift(e.id),k("like",a);const t={hobby:S.activeIndex,hobbyId:e.id};B(t).then((e=>{console.log("like data=",e)}))},L=()=>{const e={hobby:S.activeIndex};H(e).then((e=>{if(console.log("getLike=",e),200===e.data.code){const a=e.data.likes.map((e=>e.hobby_id));k("like",a);for(let e=0;e<z.value.length;e++)a.includes(z.value[e].id)?z.value[e].likeFlag=!0:z.value[e].likeFlag=!1;console.log("waterfallList====",z.value)}}))};return a((()=>{console.log("list1=",S.list),M()})),t((()=>{console.log("list2=",S.list)})),l((()=>{M()})),(e,a)=>{const t=_,l=x,y=w;return o(),s(l,{class:"waterfall"},{default:i((()=>[(o(!0),n(m,null,c(r(z),(e=>(o(),s(l,{class:"waterfall-item",style:d({top:e.top+"rpx",left:e.left+"rpx"}),key:e.id,onClick:a=>(e=>{console.log("item=",e),console.log("props===",S),b({url:`/pages/index/HobbyDetailMountain?id=${e.id}&hobby=${S.activeIndex}`})})(e)},{default:i((()=>[u(l,{class:"waterfall-image-wrapper"},{default:i((()=>[u(t,{class:"waterfall-image",mode:"widthFix",style:d({width:r(N)+"rpx"}),src:e.src},null,8,["style","src"]),e.fileType?(o(),n("svg",{key:0,class:"video-icon","aria-hidden":"true"},[g("use",{"xlink:href":"#icon-videofill"})])):v("v-if",!0)])),_:2},1024),u(l,{class:"hobby-title",ref_for:!0,ref_key:"hobbyTitle",ref:D},{default:i((()=>[f(p(e.title),1)])),_:2},1536),u(l,{class:"hobby-info"},{default:i((()=>[u(l,{class:"info"},{default:i((()=>[u(t,{class:"avatar",mode:"aspectFit",src:e.avatar},null,8,["src"]),u(y,null,{default:i((()=>[f(p(e.username),1)])),_:2},1024)])),_:2},1024),u(l,null,{default:i((()=>[e.likeFlag?(o(),n("svg",{key:0,class:"icon","aria-hidden":"true",onClick:h((a=>A(e)),["stop"])},[g("use",{"xlink:href":"#icon-xihuan1"})],8,["onClick"])):(o(),n("svg",{key:1,class:"icon","aria-hidden":"true",onClick:h((a=>A(e)),["stop"])},[g("use",{"xlink:href":"#icon-xihuan"})],8,["onClick"])),u(y,{style:{"margin-left":"10rpx"}},{default:i((()=>[f(p(e.likes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128))])),_:1})}}}),[["__scopeId","data-v-76d3b3c4"]]);const G={name:"McTabs",mounted(){console.log("this===",this)}};var J=K({components:{McTabs:K(Object.assign(G,{setup(t){I((e=>({"01adac92":r(M)})));const l=e([{title:"英语",content:[]},{title:"狼人杀",content:[]},{title:"剧本杀",content:[]},{title:"登山",content:[]},{title:"旅游",content:[]},{title:"视频",content:[]}]);let g=e(0),h=e(0);const y=S([]),k={hobby0:e=>R(e),hobby1:e=>ee(e),hobby2:e=>le(e),hobby3:e=>X(e),hobby4:e=>ie(e),hobby5:e=>de(e)},D=e=>{console.log("e=",e);const{detail:{current:a}}=e;console.log("current=",a)},O=e=>{const{detail:{current:a}}=e;g.value=a,h.value=y[g.value].width,k[`hobby${a}`]({pageNum:1,pageSize:100}),console.log("e=",e),console.log("navItemWidth.value=====",h.value)};a((()=>{const e=document.querySelectorAll(".nav-item");e.length>0&&(e.forEach((e=>{console.log("width=",e.offsetWidth),y.push({width:e.offsetWidth})})),h.value=y[g.value].width,console.log("items===",e),console.log("navItemWidth===",h.value),R({pageNum:1,pageSize:10}))}));const M=z((()=>`${h.value}rpx`));let W=e([]),B=e(1),H=e(10),K=e(0);var R=({pageNum:e=1,pageSize:a=10})=>{E({pageNum:e,pageSize:a}).then((e=>{console.log("data===",e),200===e.data.code&&(W.value=W.value.concat(e.data.data),K.value=e.data.total)}))};const G=e=>{if(0===g.value){if(Math.ceil(K.value/H.value)<=B.value)return;B.value++,R({pageNum:B.value,pageSize:H.value})}},J=e=>{console.log("item===",e),b({url:`/pages/index/VideoDetail?id=${e.id}`})};let Q=e([]),U=e(0);const X=({pageNum:e=1,pageSize:a=10})=>{const t={pageNum:e,pageSize:a,hobby:4};console.log("hobby"),V(t).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),Q.value=e.data.data,U.value=e.data.total)}))};let Y=e([]),Z=e(0);const ee=({pageNum:e=1,pageSize:a=10})=>{const t={pageNum:e,pageSize:a,hobby:2};console.log("hobby"),V(t).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),Y.value=e.data.data,Z.value=e.data.total)}))};let ae=e([]),te=e(0);const le=({pageNum:e=1,pageSize:a=10})=>{const t={pageNum:e,pageSize:a,hobby:3};console.log("hobby"),V(t).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),ae.value=e.data.data,te.value=e.data.total)}))};let oe=e([]),se=e(0);const ie=({pageNum:e=1,pageSize:a=10})=>{const t={pageNum:e,pageSize:a,hobby:5};console.log("hobby"),V(t).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),oe.value=e.data.data,se.value=e.data.total)}))};let ne=e([]),ce=e(0);const de=({pageNum:e=1,pageSize:a=10})=>{const t={pageNum:e,pageSize:a,hobby:6};console.log("hobby"),V(t).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),ne.value=e.data.data,ce.value=e.data.total)}))};return(e,a)=>{const t=w,b=x,y=T,k=_,I=A(N("uni-icons"),$),S=A(N("uni-list-item"),L),z=A(N("uni-list"),P),M=F,E=j;return o(),s(b,{class:"tabs"},{default:i((()=>[u(y,{"scroll-x":"","scroll-with-animaiton":"","enable-flex":!0,onScroll:D,class:"nav-wraper"},{default:i((()=>[u(b,{class:"nav"},{default:i((()=>[(o(!0),n(m,null,c(l.value,((e,a)=>(o(),s(b,{class:C(["nav-item",r(g)==a?"nav-item-act":""]),key:a,onClick:e=>(e=>{g.value=e})(a)},{default:i((()=>[u(t,null,{default:i((()=>[f(p(e.title),1)])),_:2},1024),r(g)==a?(o(),s(b,{key:0,class:"nav-line",style:d(`{width: ${r(h)}rpx}`)},null,8,["style"])):v("v-if",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),u(E,{current:r(g),duration:300,class:"swiper",onChange:O},{default:i((()=>[(o(!0),n(m,null,c(l.value,((e,a)=>(o(),s(M,{key:a},{default:i((()=>[u(y,{"scroll-y":"true",class:"swiper-scroll",onScrolltolower:G},{default:i((()=>[0===a?(o(),s(z,{key:0},{default:i((()=>[(o(!0),n(m,null,c(r(W),(e=>(o(),s(S,{title:e.title,ellipsis:e.title,note:e.description,key:e.id,direction:"column",class:"content-item"},{header:i((()=>[u(b,{class:"uni-thumb uni-content list-picture"},{default:i((()=>[e.img?(o(),s(k,{key:0,class:"slot-image",src:e.img,mode:"widthFix",onClick:a=>J(e)},null,8,["src","onClick"])):v("v-if",!0),e.hintTitle||e.dateSrc?(o(),s(b,{key:1,class:"hint"},{default:i((()=>[v(' <text v-if="item.hintTitle">By</text> '),e.hintTitle?(o(),s(t,{key:0,class:"hint-title"},{default:i((()=>[f(p(e.hintTitle),1)])),_:2},1024)):v("v-if",!0),u(t,{class:"hint-date"},{default:i((()=>[f(p(e.dateSrc),1)])),_:2},1024)])),_:2},1024)):v("v-if",!0)])),_:2},1024)])),body:i((()=>[u(b,{class:"content-body"},{default:i((()=>[u(b,{class:"title-wraper",onClick:a=>J(e)},{default:i((()=>[u(t,{class:"title"},{default:i((()=>[f(p(e.title),1)])),_:2},1024),u(b,{class:"video"},{default:i((()=>[u(I,{style:{"vertical-align":"middle"},type:"videocam",size:"20",color:"#999"}),u(t,null,{default:i((()=>[f("VIDEO")])),_:1})])),_:1})])),_:2},1032,["onClick"]),u(b,{class:"description"},{default:i((()=>[f(p(e.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["title","ellipsis","note"])))),128))])),_:2},1024)):1===a?(o(),n(m,{key:1},[v(' <view v-else-if="index === 3"> '),u(q,{list:r(Y),activeIndex:2},null,8,["list"])],2112)):2===a?(o(),s(q,{key:2,list:r(ae),activeIndex:3},null,8,["list"])):3===a?(o(),s(q,{key:3,list:r(Q),activeIndex:4},null,8,["list"])):4===a?(o(),s(q,{key:4,list:r(oe),activeIndex:5},null,8,["list"])):5===a?(o(),s(q,{key:5,list:r(ne),activeIndex:6},null,8,["list"])):v("v-if",!0),v(' <WaterFall v-else-if="index === 6" :list="movies" :activeIndex="7"/> '),v(" </view> "),v(" <view v-else>待上线</view> ")])),_:2},1024),v(" <slot></slot> ")])),_:2},1024)))),128))])),_:1},8,["current"])])),_:1})}}}),[["__scopeId","data-v-3ffdc930"]])},setup(){const e=D(),t=z((()=>e.state.user.userInfo)).value,l=()=>{(e=>M("/communications/imRegister","POST",e))({secret:"tuoyun",platform:5,operationID:Date.now()+""}).then((e=>{console.log("res========",e),200===e.statusCode&&W(e.data.data.token)}))},o=()=>{(e=>M("/communications/imLogin","POST",e))({userID:t.phone,secret:"tuoyun",platform:5,operationID:Date.now()+""}).then((e=>{if(console.log("res========",e),200===e.statusCode){if(e.data.data.token)return void W(e.data.data.token);l()}}))};return a((()=>{o()})),{title:"蔓草"}}},[["render",function(e,a,t,l,n,c){const d=O("McTabs"),r=x;return o(),s(r,{class:"content"},{default:i((()=>[u(d),v(' <button @click="open">打开弹窗</button> ')])),_:1})}],["__scopeId","data-v-7f712476"]]);export{J as default};
//# sourceMappingURL=pages-index-index.d43a6fa7.js.map
