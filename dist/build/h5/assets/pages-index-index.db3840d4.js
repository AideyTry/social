import{r as e,o as l,a,w as t,b as s,c as o,d as i,e as n,f as c,n as d,g as u,u as r,h as v,i as g,t as f,j as p,F as h,k as m,l as b,s as y,m as k,p as _,q as x,v as w,x as I,y as S,z,A as N,S as C,B as F,C as T,D as j,E as M,G as $,H as D,I as O}from"./index.369cd46f.js";import{_ as W}from"./uni-icons.5e3493f9.js";import{r as A}from"./uni-app.es.f32ed5fc.js";import{_ as E,a as q}from"./uni-list.18e94512.js";import{g as B,a as H}from"./hobby.4ea17b74.js";import{s as L,g as V}from"./communication.4be8edf9.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";const K={name:"waterFall"};var P=G(Object.assign(K,{props:{list:{type:Array,default:[]},activeIndex:{type:Number,default:1}},setup(w){const I=w;let S=e([]),z=e(328),N=e(2),C=e(20),F=e(20),T=e([]),j=e(null),M=e(null);const $=()=>{T.value=new Array(N.value);for(let e=0;e<T.value.length;e++)T.value[e]=0;D()},D=async()=>{for(let e=0;e<I.list.length;e++){let l=new Image;l.src=I.list[e].url,console.log("waterfall==",M.value);const a=await new Promise((a=>{l.onload=t=>{console.log("e=",t);let s={};s.height=z.value/l.width*l.height+160,s.id=I.list[e].id,s.src=I.list[e].url,s.title=I.list[e].title,s.avatar=I.list[e].avatar,s.username=I.list[e].username,s.likes=I.list[e].likes,s.fileType=I.list[e].fileType,S.value.push(s),O(s),a(s)}}));A(),console.log("img==",a)}},O=e=>{const l=Math.min.apply(null,T.value);let a=T.value.indexOf(l);e.top=T.value[a],e.left=a*(C.value+z.value),T.value[a]+=e.height+F.value,console.log("imageData==",e)},W=e=>{console.log("item=",e);let l=b("like")||[];if(l.includes(e.id)){console.log("isOK=",l);for(let a=0;a<l.length;a++)l[a]===e.id&&l.splice(a,1);e.likes-=1,e.likeFlag=!1,y("like",l)}else e.likes+=1,e.likeFlag=!0,console.log("likeIds=",l),l.unshift(e.id),y("like",l);const a={hobby:I.activeIndex,hobbyId:e.id};L(a).then((e=>{console.log("like data=",e)}))},A=()=>{const e={hobby:I.activeIndex};V(e).then((e=>{if(console.log("getLike=",e),200===e.data.code){const l=e.data.likes.map((e=>e.hobby_id));y("like",l);for(let e=0;e<S.value.length;e++)l.includes(S.value[e].id)?S.value[e].likeFlag=!0:S.value[e].likeFlag=!1;console.log("waterfallList====",S.value)}}))};return l((()=>{console.log("list1=",I.list),$()})),a((()=>{console.log("list2=",I.list)})),t((()=>{$()})),(e,l)=>{const a=k,t=_,b=x;return s(),o(t,{class:"waterfall"},{default:i((()=>[(s(!0),n(h,null,c(r(S),(e=>(s(),o(t,{class:"waterfall-item",style:d({top:e.top+"rpx",left:e.left+"rpx"}),key:e.id,onClick:l=>(e=>{console.log("item=",e),console.log("props===",I),m({url:`/pages/index/HobbyDetailMountain?id=${e.id}&hobby=${I.activeIndex}`})})(e)},{default:i((()=>[u(t,{class:"waterfall-image-wrapper"},{default:i((()=>[u(a,{class:"waterfall-image",mode:"widthFix",style:d({width:r(z)+"rpx"}),src:e.src},null,8,["style","src"]),v(' <svg class="video-icon" v-if="item.fileType" aria-hidden="true">\r\n        <use xlink:href="#icon-videofill"></use>\r\n      </svg> '),e.fileType?(s(),n("span",{key:0,class:"iconfont video-icon"},"")):v("v-if",!0)])),_:2},1024),u(t,{class:"hobby-title",ref_for:!0,ref_key:"hobbyTitle",ref:j},{default:i((()=>[g(f(e.title),1)])),_:2},1536),u(t,{class:"hobby-info"},{default:i((()=>[u(t,{class:"info"},{default:i((()=>[u(a,{class:"avatar",mode:"aspectFit",src:e.avatar},null,8,["src"]),u(b,null,{default:i((()=>[g(f(e.username),1)])),_:2},1024)])),_:2},1024),u(t,null,{default:i((()=>[v(' <svg v-if="item.likeFlag" class="icon" aria-hidden="true" @click.stop="like(item)">\r\n            <use xlink:href="#icon-xihuan1"></use>\r\n          </svg>\r\n          <svg v-else class="icon" aria-hidden="true" @click.stop="like(item)">\r\n            <use xlink:href="#icon-xihuan"></use>\r\n          </svg> '),e.likeFlag?(s(),n("span",{key:0,style:{color:"#f00"},class:"iconfont",onClick:p((l=>W(e)),["stop"])},"",8,["onClick"])):(s(),n("span",{key:1,class:"iconfont",onClick:p((l=>W(e)),["stop"])},"",8,["onClick"])),u(b,{style:{"margin-left":"10rpx"}},{default:i((()=>[g(f(e.likes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128))])),_:1})}}}),[["__scopeId","data-v-2fd3e692"]]);const J={name:"McTabs",mounted(){console.log("this===",this)}};var Q=G(Object.assign(J,{setup(a){w((e=>({"656f5d51":r(D)})));const t=e([{title:"英语",content:[]},{title:"狼人杀",content:[]},{title:"剧本杀",content:[]},{title:"登山",content:[]},{title:"旅游",content:[]},{title:"视频",content:[]}]);let p=e(0),b=e(0);const y=I([]),j={hobby0:e=>K(e),hobby1:e=>ee(e),hobby2:e=>te(e),hobby3:e=>X(e),hobby4:e=>ie(e),hobby5:e=>de(e)},M=e=>{console.log("e=",e);const{detail:{current:l}}=e;console.log("current=",l)},$=e=>{const{detail:{current:l}}=e;p.value=l,b.value=y[p.value].width,j[`hobby${l}`]({pageNum:1,pageSize:100}),console.log("e=",e),console.log("navItemWidth.value=====",b.value)};l((()=>{const e=document.querySelectorAll(".nav-item");e.length>0&&(e.forEach((e=>{console.log("width=",e.offsetWidth),y.push({width:e.offsetWidth})})),b.value=y[p.value].width,console.log("items===",e),console.log("navItemWidth===",b.value),K({pageNum:1,pageSize:10}))}));const D=S((()=>`${b.value}rpx`));let O=e([]),L=e(1),V=e(10),G=e(0);var K=({pageNum:e=1,pageSize:l=10})=>{B({pageNum:e,pageSize:l}).then((e=>{console.log("data===",e),200===e.data.code&&(O.value=O.value.concat(e.data.data),G.value=e.data.total)}))};const J=e=>{if(0===p.value){if(Math.ceil(G.value/V.value)<=L.value)return;L.value++,K({pageNum:L.value,pageSize:V.value})}},Q=e=>{console.log("item===",e),m({url:`/pages/index/VideoDetail?id=${e.id}`})};let R=e([]),U=e(0);const X=({pageNum:e=1,pageSize:l=10})=>{const a={pageNum:e,pageSize:l,hobby:4};console.log("hobby"),H(a).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),R.value=e.data.data,U.value=e.data.total)}))};let Y=e([]),Z=e(0);const ee=({pageNum:e=1,pageSize:l=10})=>{const a={pageNum:e,pageSize:l,hobby:2};console.log("hobby"),H(a).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),Y.value=e.data.data,Z.value=e.data.total)}))};let le=e([]),ae=e(0);const te=({pageNum:e=1,pageSize:l=10})=>{const a={pageNum:e,pageSize:l,hobby:3};console.log("hobby"),H(a).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),le.value=e.data.data,ae.value=e.data.total)}))};let se=e([]),oe=e(0);const ie=({pageNum:e=1,pageSize:l=10})=>{const a={pageNum:e,pageSize:l,hobby:5};console.log("hobby"),H(a).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),se.value=e.data.data,oe.value=e.data.total)}))};let ne=e([]),ce=e(0);const de=({pageNum:e=1,pageSize:l=10})=>{const a={pageNum:e,pageSize:l,hobby:6};console.log("hobby"),H(a).then((e=>{console.log("data===",e),200===e.data.code&&(console.log("data.data.data=",e.data.data),ne.value=e.data.data,ce.value=e.data.total)}))};return(e,l)=>{const a=x,m=_,y=C,w=k,I=A(z("uni-icons"),W),S=A(z("uni-list-item"),E),j=A(z("uni-list"),q),D=F,B=T;return s(),o(m,{class:"tabs"},{default:i((()=>[u(y,{"scroll-x":"","scroll-with-animaiton":"","enable-flex":!0,onScroll:M,class:"nav-wraper"},{default:i((()=>[u(m,{class:"nav"},{default:i((()=>[(s(!0),n(h,null,c(t.value,((e,l)=>(s(),o(m,{class:N(["nav-item",r(p)==l?"nav-item-act":""]),key:l,onClick:e=>(e=>{console.log("swiperIndex========================",e),p.value=e})(l)},{default:i((()=>[u(a,null,{default:i((()=>[g(f(e.title),1)])),_:2},1024),r(p)==l?(s(),o(m,{key:0,class:"nav-line",style:d(`{width: ${r(b)}rpx}`)},null,8,["style"])):v("v-if",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),u(B,{current:r(p),duration:300,class:"swiper",onChange:$},{default:i((()=>[(s(!0),n(h,null,c(t.value,((e,l)=>(s(),o(D,{key:l},{default:i((()=>[u(y,{"scroll-y":"true",class:"swiper-scroll",onScrolltolower:J},{default:i((()=>[0===l?(s(),o(j,{key:0},{default:i((()=>[(s(!0),n(h,null,c(r(O),(e=>(s(),o(S,{title:e.title,ellipsis:e.title,note:e.description,key:e.id,direction:"column",class:"content-item"},{header:i((()=>[u(m,{class:"uni-thumb uni-content list-picture"},{default:i((()=>[e.img?(s(),o(w,{key:0,class:"slot-image",src:e.img,mode:"widthFix",onClick:l=>Q(e)},null,8,["src","onClick"])):v("v-if",!0),e.hintTitle||e.dateSrc?(s(),o(m,{key:1,class:"hint"},{default:i((()=>[v(' <text v-if="item.hintTitle">By</text> '),e.hintTitle?(s(),o(a,{key:0,class:"hint-title"},{default:i((()=>[g(f(e.hintTitle),1)])),_:2},1024)):v("v-if",!0),u(a,{class:"hint-date"},{default:i((()=>[g(f(e.dateSrc),1)])),_:2},1024)])),_:2},1024)):v("v-if",!0)])),_:2},1024)])),body:i((()=>[u(m,{class:"content-body"},{default:i((()=>[u(m,{class:"title-wraper",onClick:l=>Q(e)},{default:i((()=>[u(a,{class:"title"},{default:i((()=>[g(f(e.title),1)])),_:2},1024),u(m,{class:"video"},{default:i((()=>[u(I,{style:{"vertical-align":"middle"},type:"videocam",size:"20",color:"#999"}),u(a,null,{default:i((()=>[g("VIDEO")])),_:1})])),_:1})])),_:2},1032,["onClick"]),u(m,{class:"description"},{default:i((()=>[g(f(e.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["title","ellipsis","note"])))),128))])),_:2},1024)):v("v-if",!0),v(' <view v-else-if="index === 3"> '),1===l?(s(),o(P,{key:1,list:r(Y),activeIndex:2},null,8,["list"])):2===l?(s(),o(P,{key:2,list:r(le),activeIndex:3},null,8,["list"])):3===l?(s(),o(P,{key:3,list:r(R),activeIndex:4},null,8,["list"])):4===l?(s(),o(P,{key:4,list:r(se),activeIndex:5},null,8,["list"])):5===l?(s(),o(P,{key:5,list:r(ne),activeIndex:6},null,8,["list"])):v("v-if",!0),v(' <WaterFall v-else-if="index === 6" :list="movies" :activeIndex="7"/> '),v(" </view> "),v(" <view v-else>待上线</view> ")])),_:2},1024),v(" <slot></slot> ")])),_:2},1024)))),128))])),_:1},8,["current"])])),_:1})}}}),[["__scopeId","data-v-cb851388"]]);var R=G({onShow:function(){j()>0?M({index:2,text:"···"}):$({index:2})},components:{McTabs:Q},setup(){const e=D();return S((()=>e.state.user.userInfo)).value,l((()=>{})),{title:"蔓草"}}},[["render",function(e,l,a,t,n,c){const d=O("McTabs"),r=_;return s(),o(r,{class:"content"},{default:i((()=>[u(d),v(' <button @click="open">打开弹窗</button> ')])),_:1})}],["__scopeId","data-v-5562d664"]]);export{R as default};
//# sourceMappingURL=pages-index-index.db3840d4.js.map
