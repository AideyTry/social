{"version":3,"file":"pages-user-gender-index.dc3d6924.js","sources":["../../../../src/pages/user/gender/index.vue"],"sourcesContent":["<!--\r\n * @Author: Aiden(戴林波)\r\n * @Date: 2022-01-09 17:32:15\r\n * @LastEditTime: 2022-03-31 13:48:17\r\n * @LastEditors: Aiden(戴林波)\r\n * @Description: \r\n * @Email: jason_dlb@sina.cn\r\n-->\r\n<template>\r\n  <view class=\"_showModal\" v-show=\"show\">\r\n    <view class=\"_shade\"></view>\r\n    <view class=\"_modalBox\">\r\n      <view class=\"_modal\">\r\n        <!-- <slot name=\"title\"> -->\r\n        <view class=\"title\" v-show=\"title\">{{ title }}</view>\r\n        <!-- </slot> -->\r\n        <view class=\"content-hint\"\r\n          >确定性别后无法修改！</view\r\n        >\r\n        <uni-forms ref=\"form\" :modelValue=\"formData\" :rules=\"rules\">\r\n          <!-- <slot name=\"content\"> -->\r\n          <uni-forms-item name=\"gender\">\r\n            <radio-group name=\"radio\" @change=\"radioChange\">\r\n              <label> <radio :value=\"1\" /><text>男</text> </label>\r\n              <label> <radio :value=\"2\" /><text>女</text> </label>\r\n            </radio-group>\r\n          </uni-forms-item>\r\n          <!-- </slot> -->\r\n        </uni-forms>\r\n        <!-- <slot name=\"btn\"> -->\r\n        <view class=\"btnbox\">\r\n          <button @click=\"submitForm\" class=\"btn\">确定</button>\r\n        </view>\r\n        <!-- </slot> -->\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, watchEffect } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport { setGender } from \"../../../api/user\";\r\nconst store = useStore();\r\n\r\nlet userInfo = computed(() => store.state.user.userInfo).value;\r\n\r\nconst form = ref(null);\r\nlet show = ref(true);\r\nlet title = ref(\"选择性别\");\r\nlet genderValue = ref(null);\r\nlet formData = reactive({\r\n  gender: null,\r\n});\r\nconst rules = {\r\n  gender: {\r\n    rules: [\r\n      {\r\n        required: true,\r\n        errorMessage: \"请输入昵称\",\r\n      },\r\n    ],\r\n  },\r\n};\r\n\r\nwatchEffect(() => {\r\n  if (userInfo.gender) {\r\n    show.value = false;\r\n  } else {\r\n    show.value = true;\r\n  }\r\n});\r\n\r\nconst radioChange = (e) => {\r\n  const {\r\n    detail: { value },\r\n  } = e;\r\n  form.value.setValue(\"gender\", value);\r\n};\r\n\r\nconst submitForm = () => {\r\n  form.value\r\n    .validate()\r\n    .then((res) => {\r\n      const params = {\r\n        gender: res.gender,\r\n      };\r\n      setGender(params).then((data) => {\r\n        console.log(\"data===\", data);\r\n        show.value = false;\r\n        store.dispatch(\"user/GetUserInfo\");\r\n      });\r\n    })\r\n    .catch((err) => {\r\n      console.log(\"表单错误信息：\", err);\r\n    });\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n::v-deep .uni-forms-item__content {\r\n  justify-content: center !important;\r\n  .uni-label-pointer {\r\n    margin-left: 40rpx;\r\n  }\r\n}\r\n._showModal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  z-index: 10000;\r\n  .content-hint {\r\n    margin: 40rpx 0;\r\n    color: #363636;\r\n    text-align: center;\r\n  }\r\n  ._shade {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    background: #000;\r\n    opacity: 0.6;\r\n    z-index: 11000;\r\n  }\r\n  ._modalBox {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    z-index: 12000;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    ._modal {\r\n      flex: none;\r\n      width: 70%;\r\n      // min-height:200upx;\r\n      background: #fff;\r\n      border-radius: 10rpx;\r\n      .title {\r\n        height: 40rpx;\r\n        line-height: 40rpx;\r\n        text-align: center;\r\n        font-size: 32rpx;\r\n        font-weight: bold;\r\n        padding: 15rpx 0 0;\r\n        color: #363636;\r\n        // border-bottom: 1upx solid #e1e1e1;\r\n      }\r\n      .content {\r\n        padding: 30rpx;\r\n        font-size: 24rpx;\r\n        color: #666;\r\n        line-height: 35rpx;\r\n        text-align: center;\r\n      }\r\n      .btnbox {\r\n        display: flex;\r\n        .btn {\r\n          font-size: 30rpx;\r\n          text-align: center;\r\n          flex: auto;\r\n          line-height: 80rpx;\r\n          border-top: 1rpx solid #e1e1e1;\r\n          border-right: 1rpx solid #e1e1e1;\r\n        }\r\n        .btn:last-child {\r\n          border-right: none;\r\n        }\r\n        .cancel {\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"],"names":["store","useStore","userInfo","computed","state","user","value","form","ref","show","title","formData","reactive","gender","rules","required","errorMessage","radioChange","e","detail","setValue","submitForm","validate","then","res","params","data","log","dispatch","catch","err"],"mappings":"6bA2CMA,EAAQC,QAEVC,EAAWC,GAAS,IAAMH,EAAMI,MAAMC,KAAKH,WAAUI,YAEnDC,EAAOC,EAAI,UACbC,EAAOD,GAAI,GACXE,EAAQF,EAAI,UACM,UAClBG,EAAWC,EAAS,CACtBC,OAAQ,aAEJC,EAAQ,CACZD,OAAQ,CACNC,MAAO,CACL,CACEC,UAAU,EACVC,aAAc,eAMV,KACNd,EAASW,SACNP,OAAQ,IAERA,OAAQ,WAIXW,EAAeC,UAEjBC,QAAQb,MAAEA,IACRY,IACCZ,MAAMc,SAAS,SAAUd,IAG1Be,EAAa,OACZf,MACFgB,WACAC,MAAMC,UACCC,EAAS,CACbZ,OAAQW,EAAIX,UAEJY,GAAQF,MAAMG,YACdC,IAAI,UAAWD,KAClBpB,OAAQ,IACPsB,SAAS,0BAGlBC,OAAOC,YACEH,IAAI,UAAWG"}