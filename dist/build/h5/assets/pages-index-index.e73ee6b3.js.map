{"version":3,"file":"pages-index-index.e73ee6b3.js","sources":["../../../../src/pages/index/WaterFallApp.vue","../../../../src/pages/index/McTabs.vue","../../../../src/pages/index/index.vue"],"sourcesContent":["<!--\r\n * @Author: Aiden(戴林波)\r\n * @Date: 2022-02-24 14:06:50\r\n * @LastEditTime: 2022-06-24 14:12:45\r\n * @LastEditors: Aiden(戴林波)\r\n * @Description: \r\n * @Email: jason_dlb@sina.cn\r\n-->\r\n<template>\r\n  <view class=\"waterfall\">\r\n    <view class=\"image-content\">\r\n      <image\r\n        style=\"width: 200px; height: 200px; background-color: #eeeeee\"\r\n        src=\"https://img2.chinadaily.com.cn/images/202201/21/61ea0420a310cdd3d8283bd0.jpeg\"\r\n      ></image>\r\n    </view>\r\n    <view v-for=\"item in lists\" :key=\"item.id\">\r\n      <text>{{ item.title }}</text>\r\n      <view class=\"waterfall-image-wrapper\">\r\n        <image class=\"waterfall-image\" mode=\"widthFix\" :src=\"item.url\"></image>\r\n      </view>\r\n      <text>{{ item.url }}</text>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"waterFall\",\r\n};\r\n</script>\r\n\r\n<script setup>\r\nimport {\r\n  ref,\r\n  reactive,\r\n  onMounted,\r\n  onUpdated,\r\n  getCurrentInstance,\r\n  watchEffect,\r\n} from \"vue\";\r\n\r\nimport { getLike, setLike } from \"@/api/communication.js\";\r\n\r\nconst props = defineProps({\r\n  list: {\r\n    type: Array,\r\n    default: [],\r\n  },\r\n  activeIndex: {\r\n    type: Number,\r\n    default: 1,\r\n  },\r\n});\r\nlet waterfallList = ref([]); // 需要渲染的数据列表\r\n\r\nlet lists = ref(props.list);\r\nlet waterfall = ref([\r\n  {\r\n    height: 0,\r\n    list: [],\r\n  },\r\n  {\r\n    height: 0,\r\n    list: [],\r\n  },\r\n]);\r\n\r\nlet waterfallImageWidth = ref(328); // 每一列宽度\r\n\r\nconst goDetail = (item) => {\r\n  console.log(\"item=\", item);\r\n  console.log(\"props===\", props);\r\n  uni.navigateTo({\r\n    url: `/pages/index/HobbyDetailMountain?id=${item.id}&hobby=${props.activeIndex}`,\r\n  });\r\n};\r\n\r\nconst loadImg = (ev) => {\r\n  console.log(\"ev================\", ev);\r\n  let Root = waterfall.value;\r\n  let height = e.detail.height;\r\n  // 根据当前高度决定将新数据给谁，并更新列高度；优先插入左侧\r\n  if (Root[0].height <= Root[1].height) {\r\n    // 考虑热度优先的问题， 所以用的是shift()方法推出头部数据。\r\n    Root[0].list.push(lists.shift());\r\n    Root[0].height += height;\r\n  } else {\r\n    Root[1].list.push(this.lists.shift());\r\n    Root[1].height += height;\r\n  }\r\n};\r\n\r\n// 点赞\r\nconst like = (item) => {\r\n  console.log(\"item=\", item);\r\n  // item.likeFlag = true\r\n  let likeIds = uni.getStorageSync(\"like\") || [];\r\n  if (likeIds.includes(item.id)) {\r\n    console.log(\"isOK=\", likeIds);\r\n    for (let i = 0; i < likeIds.length; i++) {\r\n      if (likeIds[i] === item.id) {\r\n        likeIds.splice(i, 1);\r\n      }\r\n    }\r\n    item.likes -= 1;\r\n    item.likeFlag = false;\r\n    uni.setStorageSync(\"like\", likeIds);\r\n  } else {\r\n    item.likes += 1;\r\n    item.likeFlag = true;\r\n    console.log(\"likeIds=\", likeIds);\r\n    likeIds.unshift(item.id);\r\n    uni.setStorageSync(\"like\", likeIds);\r\n  }\r\n  const params = { hobby: props.activeIndex, hobbyId: item.id };\r\n  setLike(params).then((data) => {\r\n    console.log(\"like data=\", data);\r\n  });\r\n};\r\n\r\nconst getLikes = () => {\r\n  const params = {\r\n    hobby: props.activeIndex,\r\n  };\r\n  getLike(params).then((data) => {\r\n    console.log(\"getLike=\", data);\r\n    if (data.data.code === 200) {\r\n      const ids = data.data.likes.map((item) => item.hobby_id);\r\n      uni.setStorageSync(\"like\", ids);\r\n      for (let i = 0; i < waterfallList.value.length; i++) {\r\n        if (ids.includes(waterfallList.value[i].id)) {\r\n          waterfallList.value[i].likeFlag = true;\r\n        } else {\r\n          waterfallList.value[i].likeFlag = false;\r\n        }\r\n      }\r\n      console.log(\"waterfallList====\", waterfallList.value);\r\n    }\r\n  });\r\n};\r\n\r\nwatchEffect(() => {\r\n  lists.value = props.list;\r\n});\r\n\r\nonMounted(() => {\r\n  console.log(\"list1=\", props.list);\r\n  console.log(\"6666lists================\", lists);\r\n});\r\nonUpdated(() => {\r\n  console.log(\"list2=\", props.list);\r\n  console.log(\"6666lists================\", lists.value);\r\n  // initWaterfall();\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.waterfall {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n}\r\n.waterfall-item {\r\n  position: absolute;\r\n  float: left;\r\n}\r\n.waterfall-image-wrapper {\r\n  position: relative;\r\n  .waterfall-image {\r\n    // position: absolue;\r\n    // display:\r\n  }\r\n  .video-icon {\r\n    position: absolute;\r\n    left: 50%;\r\n    top: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 2em;\r\n    height: 2em;\r\n    vertical-align: -0.15em;\r\n    fill: currentColor;\r\n    overflow: hidden;\r\n    opacity: 0.6;\r\n  }\r\n}\r\n.hobby-title {\r\n  position: relative;\r\n  // bottom: 0;\r\n  padding: 20rpx;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: block;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n  color: #363636;\r\n  background-color: #fff;\r\n}\r\n.hobby-info {\r\n  display: flex;\r\n  background-color: #fff;\r\n  padding: 0 20rpx 20rpx;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-size: 24rpx;\r\n  .info {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .avatar {\r\n    width: 52rpx;\r\n    height: 52rpx;\r\n    border-radius: 50%;\r\n    background-color: #ccc;\r\n    margin-right: 20rpx;\r\n  }\r\n}\r\n</style>\r\n","<!--\r\n * @Author: Aiden(戴林波)\r\n * @Date: 2022-01-16 13:32:17\r\n * @LastEditTime: 2022-06-23 17:45:57\r\n * @LastEditors: Aiden(戴林波)\r\n * @Description: \r\n * @Email: jason_dlb@sina.cn\r\n-->\r\n<template>\r\n  <view class=\"tabs\">\r\n    <scroll-view\r\n      scroll-x\r\n      scroll-with-animaiton\r\n      :enable-flex=\"true\"\r\n      @scroll=\"handleScroll\"\r\n      class=\"nav-wraper\"\r\n    >\r\n      <view class=\"nav\">\r\n        <view\r\n          class=\"nav-item\"\r\n          v-for=\"(item, index) in list\"\r\n          :key=\"index\"\r\n          :class=\"swiperIndex == index ? 'nav-item-act' : ''\"\r\n          @click=\"taggleNav(index)\"\r\n        >\r\n          <text>{{ item.title }}</text>\r\n          <view\r\n            class=\"nav-line\"\r\n            :style=\"`{width: ${navItemWidth}rpx}`\"\r\n            v-if=\"swiperIndex == index\"\r\n          ></view>\r\n        </view>\r\n      </view>\r\n    </scroll-view>\r\n    <swiper\r\n      :current=\"swiperIndex\"\r\n      :duration=\"300\"\r\n      class=\"swiper\"\r\n      @change=\"swiperChange\"\r\n    >\r\n      <swiper-item v-for=\"(item, index) in list\" :key=\"index\">\r\n        <scroll-view\r\n          scroll-y=\"true\"\r\n          class=\"swiper-scroll\"\r\n          @scrolltolower=\"onScrolltolower\"\r\n        >\r\n          <uni-list v-if=\"index === 0\">\r\n            <uni-list-item\r\n              :title=\"item.title\"\r\n              :ellipsis=\"item.title\"\r\n              :note=\"item.description\"\r\n              v-for=\"item in videos\"\r\n              :key=\"item.id\"\r\n              direction=\"column\"\r\n              class=\"content-item\"\r\n            >\r\n              <template v-slot:header>\r\n                <view class=\"uni-thumb uni-content list-picture\">\r\n                  <image\r\n                    v-if=\"item.img\"\r\n                    class=\"slot-image\"\r\n                    :src=\"item.img\"\r\n                    mode=\"widthFix\"\r\n                    @click=\"goDetail(item)\"\r\n                  ></image>\r\n                  <view class=\"hint\" v-if=\"item.hintTitle || item.dateSrc\">\r\n                    <!-- <text v-if=\"item.hintTitle\">By</text> -->\r\n                    <text v-if=\"item.hintTitle\" class=\"hint-title\">{{\r\n                      item.hintTitle\r\n                    }}</text>\r\n                    <text class=\"hint-date\">{{ item.dateSrc }}</text>\r\n                  </view>\r\n                </view>\r\n              </template>\r\n              <template v-slot:body>\r\n                <view class=\"content-body\">\r\n                  <view class=\"title-wraper\" @click=\"goDetail(item)\"\r\n                    ><text class=\"title\">{{ item.title }}</text\r\n                    ><view class=\"video\"\r\n                      ><uni-icons\r\n                        style=\"vertical-align: middle;\"\r\n                        type=\"videocam\"\r\n                        size=\"20\"\r\n                        color=\"#999\"\r\n                      ></uni-icons\r\n                      ><text>VIDEO</text></view\r\n                    ></view\r\n                  >\r\n                  <view class=\"description\">{{ item.description }}</view>\r\n                </view>\r\n              </template>\r\n            </uni-list-item>\r\n          </uni-list>\r\n          <!-- <view v-else-if=\"index === 3\"> -->\r\n          <!-- #ifdef APP-PLUS -->\r\n          <WaterFall v-if=\"index === 1\" :list=\"werewolfs\" :activeIndex=\"2\" />\r\n          <WaterFall v-else-if=\"index === 2\" :list=\"scriptKills\" :activeIndex=\"3\"/>\r\n          <WaterFall v-else-if=\"index === 3\" :list=\"mountaineers\" :activeIndex=\"4\"/>\r\n          <WaterFall v-else-if=\"index === 4\" :list=\"travels\" :activeIndex=\"5\"/>\r\n          <WaterFall v-else-if=\"index === 5\" :list=\"videoList\" :activeIndex=\"6\"/>\r\n          <!-- #endif -->\r\n          <!-- #ifdef H5 || APP-PLUS || MP-WEIXIN -->\r\n          <WaterFallApp v-if=\"index === 1\" :list=\"werewolfs\" :activeIndex=\"2\" />\r\n          <WaterFallApp v-else-if=\"index === 2\" :list=\"scriptKills\" :activeIndex=\"3\"/>\r\n          <WaterFallApp v-else-if=\"index === 3\" :list=\"mountaineers\" :activeIndex=\"4\"/>\r\n          <WaterFallApp v-else-if=\"index === 4\" :list=\"travels\" :activeIndex=\"5\"/>\r\n          <WaterFallApp v-else-if=\"index === 5\" :list=\"videoList\" :activeIndex=\"6\"/>\r\n          <!-- #endif -->\r\n          <!-- <WaterFall v-else-if=\"index === 6\" :list=\"movies\" :activeIndex=\"7\"/> -->\r\n          <!-- </view> -->\r\n          <!-- <view v-else>待上线</view> -->\r\n        </scroll-view>\r\n        <!-- <slot></slot> -->\r\n      </swiper-item>\r\n    </swiper>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"McTabs\",\r\n  mounted() {\r\n    console.log(\"this===\", this);\r\n  },\r\n};\r\n</script>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, computed } from \"vue\";\r\nimport { getVideoList, getHobbyList } from \"@/api/hobby.js\";\r\nimport WaterFall from \"./WaterFall.vue\";\r\nimport WaterFallApp from \"./WaterFallApp.vue\";\r\n\r\nconst list = ref([\r\n  { title: \"英语\", content: [] },\r\n  {\r\n    title: \"狼人杀\",\r\n    content: [],\r\n  },\r\n  { title: \"剧本杀\", content: [] },\r\n  {\r\n    title: \"登山\",\r\n    content: [],\r\n  },\r\n  {\r\n    title: \"旅游\",\r\n    content: [],\r\n  },\r\n    {\r\n    title: \"视频\",\r\n    content: [],\r\n  }\r\n]);\r\nlet swiperIndex = ref(0);\r\nlet navItemWidth = ref(0);\r\nconst navItems = reactive([]);\r\nconst strateies = {\r\n  hobby0: (obj) => getEnglishVideos(obj),\r\n  hobby1: (obj) => getWerewolf(obj),\r\n  hobby2: (obj) => getScriptKill(obj),\r\n  hobby3: (obj) => getMountaineers(obj),\r\n  hobby4: (obj) => getTravel(obj),\r\n  hobby5: (obj) => getvideoList(obj)\r\n  // hobby6: (obj) => getMovies(obj)\r\n};\r\nconst handleScroll = (e) => {\r\n  console.log(\"e=\", e);\r\n  const {\r\n    detail: { current },\r\n  } = e;\r\n  console.log(\"current=\", current);\r\n};\r\nconst taggleNav = (index) => {\r\n  swiperIndex.value = index;\r\n};\r\nconst swiperChange = (e) => {\r\n  const {\r\n    detail: { current },\r\n  } = e;\r\n  swiperIndex.value = current;\r\n  navItemWidth.value = navItems[swiperIndex.value].width;\r\n  strateies[`hobby${current}`]({ pageNum: 1, pageSize: 100 });\r\n  console.log(\"e=\", e);\r\n  console.log(\"navItemWidth.value=====\", navItemWidth.value);\r\n};\r\nonMounted(() => {\r\n  //#ifdef H5\r\n  const items = document.querySelectorAll(\".nav-item\");\r\n  if (items.length > 0) {\r\n    items.forEach((item) => {\r\n      console.log(\"width=\", item.offsetWidth);\r\n      navItems.push({ width: item.offsetWidth });\r\n    });\r\n    navItemWidth.value = navItems[swiperIndex.value].width;\r\n    console.log(\"items===\", items);\r\n    console.log(\"navItemWidth===\", navItemWidth.value);\r\n    getEnglishVideos({ pageNum: 1, pageSize: 10 });\r\n  }\r\n  //#endif\r\n\r\n  //#ifdef APP-PLUS || MP-WEIXIN\r\n   console.log('list====', list.value)\r\n   if(list.value.length > 0){\r\n      list.value.forEach(() => {\r\n          navItems.push({ width: 48 });\r\n   })\r\n    navItemWidth.value = navItems[swiperIndex.value].width;\r\n    console.log(\"navItemWidth===\", navItemWidth.value);\r\n    getEnglishVideos({ pageNum: 1, pageSize: 10 });\r\n   }\r\n  //#endif\r\n});\r\nconst result = computed(() => `${navItemWidth.value}rpx`);\r\n\r\n// 英语\r\nlet videos = ref([]);\r\nlet pageNum = ref(1);\r\nlet pageSize = ref(10);\r\nlet total = ref(0);\r\nvar getEnglishVideos = ({ pageNum = 1, pageSize = 10 }) => {\r\n  const params = {\r\n    pageNum,\r\n    pageSize,\r\n  };\r\n  getVideoList(params).then((data) => {\r\n    console.log(\"data===\", data);\r\n    if (data.data.code === 200) {\r\n      videos.value = videos.value.concat(data.data.data);\r\n      total.value = data.data.total;\r\n    }\r\n  });\r\n};\r\n\r\nconst onScrolltolower = (e) => {\r\n  if (swiperIndex.value === 0) {\r\n    if (Math.ceil(total.value / pageSize.value) <= pageNum.value) {\r\n      return;\r\n    }\r\n    pageNum.value++;\r\n    getEnglishVideos({ pageNum: pageNum.value, pageSize: pageSize.value });\r\n  }\r\n};\r\n// 暂时不用\r\nconst onScroll = (e) => {\r\n  const items = uni.createSelectorQuery().selectAll(\".content-item\");\r\n  console.log(\"items===\", items);\r\n  console.log(\"onScroll=\", e);\r\n  let scrollHeight = null;\r\n  let scrollTop = null;\r\n  let height = null;\r\n\r\n  const view = uni\r\n    .createSelectorQuery()\r\n    .select(\".swiper-scroll\")\r\n    .scrollOffset((res) => {\r\n      console.log(\"res===============================\", res);\r\n      console.log(\"竖直滚动位置\" + res.scrollTop);\r\n      scrollHeight = res.scrollHeight;\r\n      scrollTop = res.scrollTop;\r\n    })\r\n    .exec();\r\n  view\r\n    .fields(\r\n      {\r\n        size: true,\r\n        scrollOffset: true,\r\n      },\r\n      (data) => {\r\n        // console.log(\"得到节点信息\" + JSON.stringify(data));\r\n        console.log(\"节点的高为\" + data.height);\r\n        height = parseInt(data.height);\r\n      }\r\n    )\r\n    .exec();\r\n\r\n  if (scrollHeight === scrollTop + height) {\r\n    console.log(\"滚动加载了更多了\");\r\n  }\r\n};\r\n\r\nconst goDetail = (item) => {\r\n  console.log(\"item===\", item);\r\n  uni.navigateTo({\r\n    url: `/pages/index/VideoDetail?id=${item.id}`,\r\n  });\r\n};\r\n\r\n// 登山\r\nlet mountaineers = ref([]);\r\nlet mountaineersTotal = ref(0);\r\nconst getMountaineers = ({ pageNum = 1, pageSize = 10 }) => {\r\n  const params = {\r\n    pageNum,\r\n    pageSize,\r\n    hobby: 4,\r\n  };\r\n  console.log(\"hobby\");\r\n  getHobbyList(params).then((data) => {\r\n    console.log(\"data===\", data);\r\n    if (data.data.code === 200) {\r\n      console.log(\"data.data.data=\", data.data.data);\r\n      mountaineers.value = data.data.data;\r\n      mountaineersTotal.value = data.data.total;\r\n    }\r\n  });\r\n};\r\n\r\n// 狼人杀\r\nlet werewolfs = ref([]);\r\nlet werewolfsTotal = ref(0);\r\nconst getWerewolf = ({ pageNum = 1, pageSize = 10 }) => {\r\n  const params = {\r\n    pageNum,\r\n    pageSize,\r\n    hobby: 2,\r\n  };\r\n  console.log(\"hobby\");\r\n  getHobbyList(params).then((data) => {\r\n    console.log(\"data===\", data);\r\n    if (data.data.code === 200) {\r\n      console.log(\"data.data.data=\", data.data.data);\r\n      werewolfs.value = data.data.data;\r\n      werewolfsTotal.value = data.data.total;\r\n    }\r\n  });\r\n};\r\n\r\n// 剧本杀\r\nlet scriptKills = ref([]);\r\nlet scriptKillsTotal = ref(0);\r\nconst getScriptKill = ({ pageNum = 1, pageSize = 10 }) => {\r\n  const params = {\r\n    pageNum,\r\n    pageSize,\r\n    hobby: 3,\r\n  };\r\n  console.log(\"hobby\");\r\n  getHobbyList(params).then((data) => {\r\n    console.log(\"data===\", data);\r\n    if (data.data.code === 200) {\r\n      console.log(\"data.data.data=\", data.data.data);\r\n      scriptKills.value = data.data.data;\r\n      scriptKillsTotal.value = data.data.total;\r\n    }\r\n  });\r\n};\r\n\r\n// 旅游\r\nlet travels = ref([]);\r\nlet travelsTotal = ref(0);\r\nconst getTravel = ({ pageNum = 1, pageSize = 10 }) => {\r\n  const params = {\r\n    pageNum,\r\n    pageSize,\r\n    hobby: 5,\r\n  };\r\n  console.log(\"hobby\");\r\n  getHobbyList(params).then((data) => {\r\n    console.log(\"data===\", data);\r\n    if (data.data.code === 200) {\r\n      console.log(\"data.data.data=\", data.data.data);\r\n      travels.value = data.data.data;\r\n      travelsTotal.value = data.data.total;\r\n    }\r\n  });\r\n};\r\n\r\n// 视频\r\nlet videoList = ref([]);\r\nlet videoListTotal = ref(0);\r\nconst getvideoList = ({ pageNum = 1, pageSize = 10 }) => {\r\n  const params = {\r\n    pageNum,\r\n    pageSize,\r\n    hobby: 6,\r\n  };\r\n  console.log(\"hobby\");\r\n  getHobbyList(params).then((data) => {\r\n    console.log(\"data===\", data);\r\n    if (data.data.code === 200) {\r\n      console.log(\"data.data.data=\", data.data.data);\r\n      videoList.value = data.data.data;\r\n      videoListTotal.value = data.data.total;\r\n    }\r\n  });\r\n};\r\n\r\n// 电影\r\n// let movies = ref([]);\r\n// let moviesTotal = ref(0);\r\n// const getMovies = ({ pageNum = 1, pageSize = 10 }) => {\r\n//   const params = {\r\n//     pageNum,\r\n//     pageSize,\r\n//     hobby: 7,\r\n//   };\r\n//   console.log(\"hobby\");\r\n//   getHobbyList(params).then((data) => {\r\n//     console.log(\"data===\", data);\r\n//     if (data.data.code === 200) {\r\n//       console.log(\"data.data.data=\", data.data.data);\r\n//       movies.value = data.data.data;\r\n//       moviesTotal.value = data.data.total;\r\n//     }\r\n//   });\r\n// };\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.tabs {\r\n}\r\n.nav-wraper {\r\n  background: #fafafa;\r\n}\r\n.nav {\r\n  white-space: nowrap;\r\n  position: relative;\r\n  height: 60rpx;\r\n  padding: 32rpx;\r\n  border-top: 1rpx solid #dcdfe6;\r\n  border-bottom: 1rpx solid #dcdfe6;\r\n  .nav-item {\r\n    display: inline-block;\r\n    margin: 0 16rpx;\r\n    text-align: center;\r\n    transition: color 0.3s ease;\r\n    position: relative;\r\n  }\r\n  .nav-item:first-child {\r\n    margin-left: 0;\r\n  }\r\n  .nav-line {\r\n    position: absolute;\r\n    bottom: -24rpx;\r\n    // width: v-bind(result);\r\n    width: 60rpx;\r\n    height: 4rpx;\r\n    border-radius: 10rpx;\r\n    background-color: pink;\r\n    transition: left 0.3s ease;\r\n  }\r\n}\r\n.nav-item-act {\r\n  color: pink;\r\n  font-weight: bolder;\r\n}\r\n.swiper {\r\n  height: calc(100vh - 80upx);\r\n  padding: 32rpx;\r\n  background: #fdfdfd;\r\n}\r\n.swiper-scroll {\r\n  height: 100%;\r\n  .content-item {\r\n    .hint {\r\n      font-size: 14px;\r\n      font-family: Arial, Helvetica, sans-serif;\r\n      color: #999999;\r\n      margin-bottom: 10rpx;\r\n      text:first-child {\r\n        margin-right: 20rpx;\r\n      }\r\n    }\r\n    .hint-title {\r\n      color: #014073;\r\n      margin-right: 20rpx;\r\n    }\r\n    .hint-date {\r\n      // margin-left: 20rpx;\r\n    }\r\n    .content-body {\r\n      .title-wraper {\r\n        display: inline-block;\r\n        text-align: left;\r\n        .title {\r\n          // display: inline-block;\r\n          font-size: 40rpx;\r\n          font-family: \"Times New Roman\", Times, serif;\r\n          color: #000;\r\n        }\r\n        .video {\r\n          display: inline-block;\r\n          color: #999999;\r\n          font-size: 16rpx;\r\n        }\r\n      }\r\n      .description {\r\n        // text-align: left;\r\n        // margin-top: 10rpx;\r\n        // color: #666;\r\n        // font-size: 32rpx;\r\n        // font-family: Arial, Helvetica, sans-serif;\r\n        color: #666;\r\n        font-size: 32rpx;\r\n        font-family: Arial, Helvetica, sans-serif;\r\n        margin-top: 10rpx;\r\n        line-height: 40rpx;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<!--\r\n * @Author: Aiden(戴林波)\r\n * @Date: 2021-12-17 17:33:16\r\n * @LastEditTime: 2022-06-22 16:03:14\r\n * @LastEditors: Aiden(戴林波)\r\n * @Description: \r\n * @Email: jason_dlb@sina.cn\r\n-->\r\n<template>\r\n  <view class=\"content\">\r\n    <McTabs> </McTabs>\r\n    <!-- <button @click=\"open\">打开弹窗</button> -->\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { onMounted, computed } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport { imRegister, imLogin } from \"@/api/im.js\";\r\nimport { setIMToken } from \"../../utils/auth.js\";\r\nimport McTabs from \"./McTabs.vue\";\r\nimport { getTotalIM } from \"@/utils/storage.js\";\r\nexport default {\r\n  onShow: function() {\r\n    if (getTotalIM() > 0) {\r\n      uni.setTabBarBadge({\r\n        index: 2,\r\n        text: \"···\",\r\n      });\r\n    } else {\r\n      //#ifdef APP-PLUS || H5\r\n      uni.removeTabBarBadge({\r\n        index: 2,\r\n      });\r\n      //#endif\r\n    }\r\n  },\r\n  components: {\r\n    McTabs,\r\n  },\r\n  setup() {\r\n    const store = useStore();\r\n    const userInfo = computed(() => store.state.user.userInfo).value;\r\n    const register = () => {\r\n      const params = {\r\n        secret: \"tuoyun\",\r\n        platform: 5,\r\n        operationID: Date.now() + \"\",\r\n      };\r\n      imRegister(params).then((res) => {\r\n        console.log(\"res========\", res);\r\n        if (res.statusCode === 200) {\r\n          console.log(\"res.data.token====\", res.data.token);\r\n          setIMToken(res.data.token);\r\n          // connectIM(res.data.data.userID, res.data.data.token);\r\n        }\r\n      });\r\n    };\r\n    const login = () => {\r\n      const params = {\r\n        userID: userInfo.phone,\r\n        secret: \"tuoyun\",\r\n        platform: 5,\r\n        operationID: Date.now() + \"\",\r\n      };\r\n      imLogin(params).then((res) => {\r\n        console.log(\"res========\", res);\r\n        if (res.statusCode === 200) {\r\n          if (res.data.errCode !== 0) {\r\n            register();\r\n            return;\r\n          }\r\n          if (res.data.data.token) {\r\n            console.log(\"res.data.token=\", res.data.token);\r\n            setIMToken(res.data.data.token);\r\n          }\r\n          // connectIM(res.data.data.userID, res.data.data.token);\r\n        }\r\n      });\r\n    };\r\n    onMounted(() => {\r\n      // connectIM(userID, token);\r\n      // login();\r\n      // resiger()\r\n      // console.log('userInfo=========================', userInfo.phone)\r\n    });\r\n    return {\r\n      title: \"蔓草\",\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.content {\r\n  /* display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center; */\r\n  /* background: #fdfdfd; */\r\n  /* padding: 0 32rpx; */\r\n}\r\n\r\n.logo {\r\n  height: 200rpx;\r\n  width: 200rpx;\r\n  margin-top: 200rpx;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  margin-bottom: 50rpx;\r\n}\r\n\r\n.text-area {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.title {\r\n  font-size: 36rpx;\r\n  color: #8f8f94;\r\n}\r\n.change-gender {\r\n  display: flex;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n}\r\n</style>\r\n"],"names":["name","lists","ref","props","list","height","value","log","mounted","this","title","content","swiperIndex","navItemWidth","navItems","reactive","strateies","hobby0","obj","getEnglishVideos","hobby1","getWerewolf","hobby2","getScriptKill","hobby3","getMountaineers","hobby4","getTravel","hobby5","getvideoList","handleScroll","e","detail","current","swiperChange","width","pageNum","pageSize","items","document","querySelectorAll","length","forEach","item","offsetWidth","push","result","computed","videos","total","then","data","code","concat","onScrolltolower","Math","ceil","goDetail","url","id","mountaineers","mountaineersTotal","params","hobby","werewolfs","werewolfsTotal","scriptKills","scriptKillsTotal","travels","travelsTotal","videoList","videoListTotal","index2","onShow","getTotalIM","index","text","components","McTabs","setup","store","useStore","state","user","userInfo","_createBlock","_component_v_uni_view","class","_createVNode","_component_McTabs","_createCommentVNode"],"mappings":"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"}