var e,n,r,t=function(){function e(){this.events=void 0,this.events={}}var n=e.prototype;return n.emit=function(e,n){return this.events[e]&&this.events[e].forEach((function(e){return e(n)})),this},n.on=function(e,n){return this.events[e]?this.events[e].push(n):this.events[e]=[n],this},n.off=function(e,n){if(e&&"function"==typeof n){var r=this.events[e],t=r.findIndex((function(e){return e===n}));r.splice(t,1)}else this.events[e]=[];return this},e}();function i(e,n){return(i=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}(r=e||(e={})).INITSDK="InitSDK",r.LOGIN="Login",r.LOGOUT="Logout",r.GETLOGINSTATUS="GetLoginStatus",r.GETLOGINUSER="GetLoginUser",r.GETSELFUSERINFO="GetSelfUserInfo",r.CREATETEXTMESSAGE="CreateTextMessage",r.CREATETEXTATMESSAGE="CreateTextAtMessage",r.CREATEIMAGEMESSAGEFROMBYURL="CreateImageMessageByURL",r.CREATESOUNDMESSAGEBYURL="CreateSoundMessageByURL",r.CREATEVIDEOMESSAGEBYURL="CreateVideoMessageByURL",r.CREATEFILEMESSAGEBYURL="CreateFileMessageByURL",r.CREATEIMAGEMESSAGEFROMFULLPATH="CreateImageMessageFromFullPath",r.CREATESOUNDMESSAGEFROMFULLPATH="CreateSoundMessageFromFullPath",r.CREATEVIDEOMESSAGEFROMFULLPATH="CreateVideoMessageFromFullPath",r.CREATEFILEMESSAGEFROMFULLPATH="CreateFileMessageFromFullPath",r.CREATELOCATIONMESSAGE="CreateLocationMessage",r.CREATECUSTOMMESSAGE="CreateCustomMessage",r.CREATEMERGERMESSAGE="CreateMergerMessage",r.CREATEFORWARDMESSAGE="CreateForwardMessage",r.CREATEQUOTEMESSAGE="CreateQuoteMessage",r.CREATECARDMESSAGE="CreateCardMessage",r.CREATEFACEMESSAGE="CreateFaceMessage",r.SENDMESSAGE="SendMessage",r.SENDMESSAGENOTOSS="SendMessageNotOss",r.GETHISTORYMESSAGELIST="GetHistoryMessageList",r.REVOKEMESSAGE="RevokeMessage",r.SETONECONVERSATIONPRIVATECHAT="SetOneConversationPrivateChat",r.DELETEMESSAGEFROMLOCALSTORAGE="DeleteMessageFromLocalStorage",r.DELETEMESSAGEFROMLOCALANDSVR="DeleteMessageFromLocalAndSvr",r.DELETECONVERSATIONFROMLOCALANDSVR="DeleteConversationFromLocalAndSvr",r.DELETEALLMSGFROMLOCALANDSVR="DeleteAllMsgFromLocalAndSvr",r.DELETEALLMSGFROMLOCAL="DeleteAllMsgFromLocal",r.MARKSINGLEMESSAGEHASREAD="MarkSingleMessageHasRead",r.INSERTSINGLEMESSAGETOLOCALSTORAGE="InsertSingleMessageToLocalStorage",r.INSERTGROUPMESSAGETOLOCALSTORAGE="InsertGroupMessageToLocalStorage",r.TYPINGSTATUSUPDATE="TypingStatusUpdate",r.MARKC2CMESSAGEASREAD="MarkC2CMessageAsRead",r.MARKMESSAGEASREADBYCONID="MarkMessageAsReadByConID",r.CLEARC2CHISTORYMESSAGE="ClearC2CHistoryMessage",r.CLEARGROUPHISTORYMESSAGE="ClearGroupHistoryMessage",r.ADDFRIEND="AddFriend",r.GETDESIGNATEDFRIENDSINFO="GetDesignatedFriendsInfo",r.GETRECVFRIENDAPPLICATIONLIST="GetRecvFriendApplicationList",r.GETSENDFRIENDAPPLICATIONLIST="GetSendFriendApplicationList",r.GETFRIENDLIST="GetFriendList",r.SETFRIENDREMARK="SetFriendRemark",r.ADDBLACK="AddBlack",r.GETBLACKLIST="GetBlackList",r.REMOVEBLACK="RemoveBlack",r.CHECKFRIEND="CheckFriend",r.ACCEPTFRIENDAPPLICATION="AcceptFriendApplication",r.REFUSEFRIENDAPPLICATION="RefuseFriendApplication",r.DELETEFRIEND="DeleteFriend",r.GETUSERSINFO="GetUsersInfo",r.SETSELFINFO="SetSelfInfo",r.GETALLCONVERSATIONLIST="GetAllConversationList",r.GETCONVERSATIONLISTSPLIT="GetConversationListSplit",r.GETONECONVERSATION="GetOneConversation",r.GETCONVERSATIONIDBYSESSIONTYPE="GetConversationIDBySessionType",r.GETMULTIPLECONVERSATION="GetMultipleConversation",r.DELETECONVERSATION="DeleteConversation",r.SETCONVERSATIONDRAFT="SetConversationDraft",r.PINCONVERSATION="PinConversation",r.GETTOTALUNREADMSGCOUNT="GetTotalUnreadMsgCount",r.GETCONVERSATIONRECVMESSAGEOPT="GetConversationRecvMessageOpt",r.SETCONVERSATIONRECVMESSAGEOPT="SetConversationRecvMessageOpt",r.SEARCHLOCALMESSAGES="SearchLocalMessages",r.MARKGROUPMESSAGEHASREAD="MarkGroupMessageHasRead",r.MARKGROUPMESSAGEASREAD="MarkGroupMessageAsRead",r.INVITEUSERTOGROUP="InviteUserToGroup",r.KICKGROUPMEMBER="KickGroupMember",r.GETGROUPMEMBERSINFO="GetGroupMembersInfo",r.GETGROUPMEMBERLIST="GetGroupMemberList",r.GETJOINEDGROUPLIST="GetJoinedGroupList",r.CREATEGROUP="CreateGroup",r.SETGROUPINFO="SetGroupInfo",r.GETGROUPSINFO="GetGroupsInfo",r.JOINGROUP="JoinGroup",r.QUITGROUP="QuitGroup",r.DISMISSGROUP="DismissGroup",r.CHANGEGROUPMUTE="ChangeGroupMute",r.CHANGEGROUPMEMBERMUTE="ChangeGroupMemberMute",r.TRANSFERGROUPOWNER="TransferGroupOwner",r.GETSENDGROUPAPPLICATIONLIST="GetSendGroupApplicationList",r.GETRECVGROUPAPPLICATIONLIST="GetRecvGroupApplicationList",r.ACCEPTGROUPAPPLICATION="AcceptGroupApplication",r.REFUSEGROUPAPPLICATION="RefuseGroupApplication",r.SIGNALINGINVITE="SignalingInvite",r.SIGNALINGINVITEINGROUP="SignalingInviteInGroup",r.SIGNALINGACCEPT="SignalingAccept",r.SIGNALINGREJECT="SignalingReject",r.SIGNALINGCANCEL="SignalingCancel",function(e){e.ONCONNECTFAILED="OnConnectFailed",e.ONCONNECTSUCCESS="OnConnectSuccess",e.ONCONNECTING="OnConnecting",e.ONKICKEDOFFLINE="OnKickedOffline",e.ONSELFINFOUPDATED="OnSelfInfoUpdated",e.ONUSERTOKENEXPIRED="OnUserTokenExpired",e.ONPROGRESS="OnProgress",e.ONRECVNEWMESSAGE="OnRecvNewMessage",e.ONRECVMESSAGEREVOKED="OnRecvMessageRevoked",e.ONRECVC2CREADRECEIPT="OnRecvC2CReadReceipt",e.ONRECVGROUPREADRECEIPT="OnRecvGroupReadReceipt",e.ONCONVERSATIONCHANGED="OnConversationChanged",e.ONNEWCONVERSATION="OnNewConversation",e.ONSYNCSERVERFAILED="OnSyncServerFailed",e.ONSYNCSERVERFINISH="OnSyncServerFinish",e.ONSYNCSERVERSTART="OnSyncServerStart",e.ONTOTALUNREADMESSAGECOUNTCHANGED="OnTotalUnreadMessageCountChanged",e.ONBLACKADDED="OnBlackAdded",e.ONBLACKDELETED="OnBlackDeleted",e.ONFRIENDAPPLICATIONACCEPTED="OnFriendApplicationAccepted",e.ONFRIENDAPPLICATIONADDED="OnFriendApplicationAdded",e.ONFRIENDAPPLICATIONDELETED="OnFriendApplicationDeleted",e.ONFRIENDAPPLICATIONREJECTED="OnFriendApplicationRejected",e.ONFRIENDINFOCHANGED="OnFriendInfoChanged",e.ONFRIENDADDED="OnFriendAdded",e.ONFRIENDDELETED="OnFriendDeleted",e.ONJOINEDGROUPADDED="OnJoinedGroupAdded",e.ONJOINEDGROUPDELETED="OnJoinedGroupDeleted",e.ONGROUPMEMBERADDED="OnGroupMemberAdded",e.ONGROUPMEMBERDELETED="OnGroupMemberDeleted",e.ONGROUPAPPLICATIONADDED="OnGroupApplicationAdded",e.ONGROUPAPPLICATIONDELETED="OnGroupApplicationDeleted",e.ONGROUPINFOCHANGED="OnGroupInfoChanged",e.ONGROUPMEMBERINFOCHANGED="OnGroupMemberInfoChanged",e.ONGROUPAPPLICATIONACCEPTED="OnGroupApplicationAccepted",e.ONGROUPAPPLICATIONREJECTED="OnGroupApplicationRejected",e.ONRECEIVENEWINVITATION="OnReceiveNewInvitation",e.ONINVITEEACCEPTED="OnInviteeAccepted",e.ONINVITEEREJECTED="OnInviteeRejected",e.ONINVITATIONCANCELLED="OnInvitationCancelled",e.ONINVITATIONTIMEOUT="OnInvitationTimeout",e.ONINVITEEACCEPTEDBYOTHERDEVICE="OnInviteeAcceptedByOtherDevice",e.ONINVITEEREJECTEDBYOTHERDEVICE="OnInviteeRejectedByOtherDevice"}(n||(n={}));var o=function(e){return(36*Math.random()).toString(36).slice(2)+(new Date).getTime().toString()+e},a=function(r){var t,a;function u(){var t;return(t=r.call(this)||this).ws=void 0,t.uid=void 0,t.token=void 0,t.platform="web",t.wsUrl="",t.lock=!1,t.logoutFlag=!1,t.ws2promise={},t.onceFlag=!0,t.getLoginStatus=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETLOGINSTATUS,operationID:a,userID:t.uid,data:""},r,i)}))},t.getLoginUser=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETLOGINUSER,operationID:a,userID:t.uid,data:""},r,i)}))},t.getSelfUserInfo=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETSELFUSERINFO,operationID:a,userID:t.uid,data:""},r,i)}))},t.getUsersInfo=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETUSERSINFO,operationID:u,userID:t.uid,data:n},i,a)}))},t.setSelfInfo=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.SETSELFINFO,operationID:u,userID:t.uid,data:n},i,a)}))},t.createTextMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATETEXTMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.createTextAtMessage=function(n,r){return new Promise((function(i,a){var u=n;u.atUserIDList=JSON.stringify(u.atUserIDList);var s=r||o(t.uid);t.wsSend({reqFuncName:e.CREATETEXTATMESSAGE,operationID:s,userID:t.uid,data:u},i,a)}))},t.createImageMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.bigPicture=JSON.stringify(s.bigPicture),s.snapshotPicture=JSON.stringify(s.snapshotPicture),s.sourcePicture=JSON.stringify(s.sourcePicture);var E={reqFuncName:e.CREATEIMAGEMESSAGEFROMBYURL,operationID:u,userID:t.uid,data:JSON.stringify(s)};t.wsSend(E,i,a)}))},t.createSoundMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s={soundBaseInfo:JSON.stringify(n)},E={reqFuncName:e.CREATESOUNDMESSAGEBYURL,operationID:u,userID:t.uid,data:JSON.stringify(s)};t.wsSend(E,i,a)}))},t.createVideoMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s={videoBaseInfo:JSON.stringify(n)},E={reqFuncName:e.CREATEVIDEOMESSAGEBYURL,operationID:u,userID:t.uid,data:JSON.stringify(s)};t.wsSend(E,i,a)}))},t.createFileMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s={fileBaseInfo:JSON.stringify(n)},E={reqFuncName:e.CREATEFILEMESSAGEBYURL,operationID:u,userID:t.uid,data:JSON.stringify(s)};t.wsSend(E,i,a)}))},t.createFileMessageFromFullPath=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATEFILEMESSAGEFROMFULLPATH,operationID:u,userID:t.uid,data:n},i,a)}))},t.createImageMessageFromFullPath=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATEIMAGEMESSAGEFROMFULLPATH,operationID:u,userID:t.uid,data:n},i,a)}))},t.createSoundMessageFromFullPath=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATESOUNDMESSAGEFROMFULLPATH,operationID:u,userID:t.uid,data:n},i,a)}))},t.createVideoMessageFromFullPath=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATEVIDEOMESSAGEFROMFULLPATH,operationID:u,userID:t.uid,data:n},i,a)}))},t.createMergerMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.messageList=JSON.stringify(n.messageList),s.summaryList=JSON.stringify(n.summaryList),t.wsSend({reqFuncName:e.CREATEMERGERMESSAGE,operationID:u,userID:t.uid,data:s},i,a)}))},t.createForwardMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATEFORWARDMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.createFaceMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATEFACEMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.createLocationMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATELOCATIONMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.createCustomMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATECUSTOMMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.createQuoteMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATEQUOTEMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.createCardMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CREATECARDMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.sendMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.offlinePushInfo=s.offlinePushInfo?JSON.stringify(n.offlinePushInfo):"",t.wsSend({reqFuncName:e.SENDMESSAGE,operationID:u,userID:t.uid,data:s},i,a)}))},t.sendMessageNotOss=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.offlinePushInfo=s.offlinePushInfo?JSON.stringify(n.offlinePushInfo):"",t.wsSend({reqFuncName:e.SENDMESSAGENOTOSS,operationID:u,userID:t.uid,data:s},i,a)}))},t.getHistoryMessageList=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETHISTORYMESSAGELIST,operationID:u,userID:t.uid,data:n},i,a)}))},t.revokeMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.REVOKEMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.setOneConversationPrivateChat=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.SETONECONVERSATIONPRIVATECHAT,operationID:u,userID:t.uid,data:n},i,a)}))},t.deleteMessageFromLocalStorage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.DELETEMESSAGEFROMLOCALSTORAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.deleteMessageFromLocalAndSvr=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.DELETEMESSAGEFROMLOCALANDSVR,operationID:u,userID:t.uid,data:n},i,a)}))},t.deleteConversationFromLocalAndSvr=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.DELETECONVERSATIONFROMLOCALANDSVR,operationID:u,userID:t.uid,data:n},i,a)}))},t.deleteAllMsgFromLocal=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.DELETEALLMSGFROMLOCAL,operationID:a,userID:t.uid,data:""},r,i)}))},t.deleteAllMsgFromLocalAndSvr=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.DELETEALLMSGFROMLOCALANDSVR,operationID:a,userID:t.uid,data:""},r,i)}))},t.markGroupMessageHasRead=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.MARKGROUPMESSAGEHASREAD,operationID:u,userID:t.uid,data:n},i,a)}))},t.markGroupMessageAsRead=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.msgIDList=JSON.stringify(s.msgIDList),t.wsSend({reqFuncName:e.MARKGROUPMESSAGEASREAD,operationID:u,userID:t.uid,data:s},i,a)}))},t.insertSingleMessageToLocalStorage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.INSERTSINGLEMESSAGETOLOCALSTORAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.insertGroupMessageToLocalStorage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.INSERTGROUPMESSAGETOLOCALSTORAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.typingStatusUpdate=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.TYPINGSTATUSUPDATE,operationID:u,userID:t.uid,data:n},i,a)}))},t.markC2CMessageAsRead=function(n,r){return new Promise((function(i,a){var u=n;u.msgIDList=JSON.stringify(u.msgIDList);var s=r||o(t.uid);t.wsSend({reqFuncName:e.MARKC2CMESSAGEASREAD,operationID:s,userID:t.uid,data:u},i,a)}))},t.markMessageAsReadByConID=function(n,r){return new Promise((function(i,a){var u=n;u.msgIDList=JSON.stringify(u.msgIDList);var s=r||o(t.uid);t.wsSend({reqFuncName:e.MARKMESSAGEASREADBYCONID,operationID:s,userID:t.uid,data:u},i,a)}))},t.clearC2CHistoryMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CLEARC2CHISTORYMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.clearGroupHistoryMessage=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CLEARGROUPHISTORYMESSAGE,operationID:u,userID:t.uid,data:n},i,a)}))},t.getAllConversationList=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETALLCONVERSATIONLIST,operationID:a,userID:t.uid,data:""},r,i)}))},t.getConversationListSplit=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETCONVERSATIONLISTSPLIT,operationID:u,userID:t.uid,data:n},i,a)}))},t.getOneConversation=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETONECONVERSATION,operationID:u,userID:t.uid,data:n},i,a)}))},t.getConversationIDBySessionType=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETCONVERSATIONIDBYSESSIONTYPE,operationID:u,userID:t.uid,data:n},i,a)}))},t.getMultipleConversation=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETMULTIPLECONVERSATION,operationID:u,userID:t.uid,data:n},i,a)}))},t.deleteConversation=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.DELETECONVERSATION,operationID:u,userID:t.uid,data:n},i,a)}))},t.setConversationDraft=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.SETCONVERSATIONDRAFT,operationID:u,userID:t.uid,data:n},i,a)}))},t.pinConversation=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.PINCONVERSATION,operationID:u,userID:t.uid,data:n},i,a)}))},t.getTotalUnreadMsgCount=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETTOTALUNREADMSGCOUNT,operationID:a,userID:t.uid,data:""},r,i)}))},t.getConversationRecvMessageOpt=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETCONVERSATIONRECVMESSAGEOPT,operationID:u,userID:t.uid,data:n},i,a)}))},t.setConversationRecvMessageOpt=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.conversationIDList=JSON.stringify(n.conversationIDList),t.wsSend({reqFuncName:e.SETCONVERSATIONRECVMESSAGEOPT,operationID:u,userID:t.uid,data:s},i,a)}))},t.searchLocalMessages=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.SEARCHLOCALMESSAGES,operationID:u,userID:t.uid,data:n},i,a)}))},t.addFriend=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.ADDFRIEND,operationID:u,userID:t.uid,data:n},i,a)}))},t.getDesignatedFriendsInfo=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETDESIGNATEDFRIENDSINFO,operationID:u,userID:t.uid,data:n},i,a)}))},t.getRecvFriendApplicationList=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETRECVFRIENDAPPLICATIONLIST,operationID:a,userID:t.uid,data:""},r,i)}))},t.getSendFriendApplicationList=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETSENDFRIENDAPPLICATIONLIST,operationID:a,userID:t.uid,data:""},r,i)}))},t.getFriendList=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETFRIENDLIST,operationID:a,userID:t.uid,data:""},r,i)}))},t.setFriendRemark=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.SETFRIENDREMARK,operationID:u,userID:t.uid,data:n},i,a)}))},t.checkFriend=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CHECKFRIEND,operationID:u,userID:t.uid,data:n},i,a)}))},t.acceptFriendApplication=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.ACCEPTFRIENDAPPLICATION,operationID:u,userID:t.uid,data:n},i,a)}))},t.refuseFriendApplication=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.REFUSEFRIENDAPPLICATION,operationID:u,userID:t.uid,data:n},i,a)}))},t.deleteFriend=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.DELETEFRIEND,operationID:u,userID:t.uid,data:n},i,a)}))},t.addBlack=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.ADDBLACK,operationID:u,userID:t.uid,data:n},i,a)}))},t.removeBlack=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.REMOVEBLACK,operationID:u,userID:t.uid,data:n},i,a)}))},t.getBlackList=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETBLACKLIST,operationID:a,userID:t.uid,data:""},r,i)}))},t.inviteUserToGroup=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.userIDList=JSON.stringify(s.userIDList),t.wsSend({reqFuncName:e.INVITEUSERTOGROUP,operationID:u,userID:t.uid,data:s},i,a)}))},t.kickGroupMember=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.userIDList=JSON.stringify(s.userIDList),t.wsSend({reqFuncName:e.KICKGROUPMEMBER,operationID:u,userID:t.uid,data:s},i,a)}))},t.getGroupMembersInfo=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.userIDList=JSON.stringify(s.userIDList),t.wsSend({reqFuncName:e.GETGROUPMEMBERSINFO,operationID:u,userID:t.uid,data:s},i,a)}))},t.getGroupMemberList=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETGROUPMEMBERLIST,operationID:u,userID:t.uid,data:n},i,a)}))},t.getJoinedGroupList=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETJOINEDGROUPLIST,operationID:a,userID:t.uid,data:""},r,i)}))},t.createGroup=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.groupBaseInfo=JSON.stringify(s.groupBaseInfo),s.memberList=JSON.stringify(s.memberList),t.wsSend({reqFuncName:e.CREATEGROUP,operationID:u,userID:t.uid,data:s},i,a)}))},t.setGroupInfo=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s=n;s.groupInfo=JSON.stringify(s.groupInfo),t.wsSend({reqFuncName:e.SETGROUPINFO,operationID:u,userID:t.uid,data:s},i,a)}))},t.getGroupsInfo=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.GETGROUPSINFO,operationID:u,userID:t.uid,data:n},i,a)}))},t.joinGroup=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.JOINGROUP,operationID:u,userID:t.uid,data:n},i,a)}))},t.quitGroup=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.QUITGROUP,operationID:u,userID:t.uid,data:n},i,a)}))},t.dismissGroup=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.DISMISSGROUP,operationID:u,userID:t.uid,data:n},i,a)}))},t.changeGroupMute=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CHANGEGROUPMUTE,operationID:u,userID:t.uid,data:n},i,a)}))},t.changeGroupMemberMute=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.CHANGEGROUPMEMBERMUTE,operationID:u,userID:t.uid,data:n},i,a)}))},t.transferGroupOwner=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.TRANSFERGROUPOWNER,operationID:u,userID:t.uid,data:n},i,a)}))},t.getSendGroupApplicationList=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETSENDGROUPAPPLICATIONLIST,operationID:a,userID:t.uid,data:""},r,i)}))},t.getRecvGroupApplicationList=function(n){return new Promise((function(r,i){var a=n||o(t.uid);t.wsSend({reqFuncName:e.GETRECVGROUPAPPLICATIONLIST,operationID:a,userID:t.uid,data:""},r,i)}))},t.acceptGroupApplication=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.ACCEPTGROUPAPPLICATION,operationID:u,userID:t.uid,data:n},i,a)}))},t.refuseGroupApplication=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.REFUSEGROUPAPPLICATION,operationID:u,userID:t.uid,data:n},i,a)}))},t.signalingInvite=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s={};s.invitation=n,t.wsSend({reqFuncName:e.SIGNALINGINVITE,operationID:u,userID:t.uid,data:s},i,a)}))},t.signalingInviteInGroup=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid),s={};s.invitation=n,t.wsSend({reqFuncName:e.SIGNALINGINVITEINGROUP,operationID:u,userID:t.uid,data:s},i,a)}))},t.signalingAccept=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.SIGNALINGACCEPT,operationID:u,userID:t.uid,data:n},i,a)}))},t.signalingReject=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.SIGNALINGREJECT,operationID:u,userID:t.uid,data:n},i,a)}))},t.signalingCancel=function(n,r){return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.SIGNALINGCANCEL,operationID:u,userID:t.uid,data:n},i,a)}))},t.wsSend=function(r,i,a){void 0===t.ws&&a({event:r.reqFuncName,errCode:112,errMsg:"ws conect failed...",data:"",operationID:r.operationID||""}),"object"==typeof r.data&&(r.data=JSON.stringify(r.data));var u={oid:r.operationID||o(t.uid),mname:r.reqFuncName,mrsve:i,mrjet:a,flag:!1};t.ws2promise[u.oid]=u;var s=function(i){var o=JSON.parse(i.data);if(n[o.event.toUpperCase()])t.emit(o.event,o);else{r.reqFuncName===e.LOGOUT&&(t.logoutFlag=!0,t.ws.close(),t.ws=void 0);var a=t.ws2promise[o.operationID];a&&(0===o.errCode?a.mrsve(o):a.mrjet(o),delete t.ws2promise[o.operationID])}};"web"==t.platform?(t.ws.send(JSON.stringify(r)),t.ws.onmessage=s):(t.ws.send({data:JSON.stringify(r),success:function(e){"uni"===t.platform&&void 0!==t.ws._callbacks&&void 0!==t.ws._callbacks.message&&(t.ws._callbacks.message=[])}}),t.onceFlag&&(t.ws.onMessage(s),t.onceFlag=!1)),r.reqFuncName===e.LOGOUT&&(t.onceFlag=!0)},t.getPlatform(),t}a=r,(t=u).prototype=Object.create(a.prototype),t.prototype.constructor=t,i(t,a);var s=u.prototype;return s.login=function(n){var r=this;return new Promise((function(t,i){var o=n.userID,a=n.token,u=n.operationID;r.wsUrl=n.url+"?sendID="+o+"&token="+a+"&platformID="+n.platformID;var s={userID:o,token:a},E={event:e.LOGIN,errCode:0,errMsg:"",data:"",operationID:u||""};r.createWs((function(){r.uid=o,r.token=a,r.iLogin(s,u).then((function(e){r.logoutFlag=!1,t(e)})).catch((function(e){E.errCode=e.errCode,E.errMsg=e.errMsg,i(E)}))}),(function(){E.errCode=111,E.errMsg="ws connect close...",r.logoutFlag||r.reconnect(),i(E)}),(function(e){console.log(e),E.errCode=112,E.errMsg="ws connect error...",i(E)})),r.ws||(E.errCode=112,E.errMsg="The current platform is not supported...",i(E))}))},s.iLogin=function(n,r){var t=this;return new Promise((function(i,a){var u=r||o(t.uid);t.wsSend({reqFuncName:e.LOGIN,operationID:u,userID:t.uid,data:n},i,a)}))},s.logout=function(n){var r=this;return new Promise((function(t,i){var a=n||o(r.uid);r.wsSend({reqFuncName:e.LOGOUT,operationID:a,userID:r.uid,data:""},t,i)}))},s.getPlatform=function(){var e=typeof WebSocket,n=typeof uni,r=typeof wx;this.platform="undefined"===e?"object"===n&&"object"!==r?"uni":"object"!==n&&"object"===r?"wx":"unknow":"web"},s.createWs=function(e,n,r){var t=this;console.log("call createWs:::");var i=function(){t.iLogin({userID:t.uid,token:t.token}).then((function(e){return t.logoutFlag=!1}))};e&&(i=e);var o=function(){console.log("ws close agin:::"),t.logoutFlag||t.reconnect()};n&&(o=n);var a=function(){};if(r&&(a=r),"web"===this.platform)return this.ws=new WebSocket(this.wsUrl),this.ws.onclose=o,this.ws.onopen=i,void(this.ws.onerror=a);var u="uni"===this.platform?uni:wx;this.ws=u.connectSocket({url:this.wsUrl,complete:function(){}}),this.ws.onClose(o),this.ws.onOpen(i),this.ws.onError(a)},s.reconnect=function(){var e=this;this.onceFlag||(this.onceFlag=!0),this.lock||(this.lock=!0,setTimeout((function(){e.createWs(),e.lock=!1}),2e3))},u}(t);const u=new a;export{u as o};
//# sourceMappingURL=openIM.fd559ab0.js.map
