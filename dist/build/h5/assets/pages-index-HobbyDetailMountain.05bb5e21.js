import{D as o,E as a,a6 as e,o as l,H as t,e as s,w as n,N as c,O as d,K as u,a7 as i,Q as r,I as b,c as f,M as h,U as m,T as y,S as p,a8 as _,a9 as v,X as I,W as g,a1 as w,Z as j,n as x,l as k,aa as F}from"./vendor.2a2b33f0.js";import{b as V}from"./hobby.a67b8f20.js";import{a as C,b as T,d as $,c as D,e as O}from"./communication.9103250d.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import{V as U}from"./VideoPlayer.2510c395.js";import{f as q}from"./index.ed016f60.js";const z={name:"comment"};var A=P({components:{Comment:P(Object.assign(z,{props:{hobbyInfo:{type:Object,default:{}}},setup(v){const I=v;let g=o(""),w=o(0),j=o([]);console.log("props=",I);const x=o=>{console.log("e=",o);const{detail:{value:a}}=o;let e={comment:a,detailUserId:I.hobbyInfo.user_id,hobbyId:I.hobbyInfo[`hobby_${I.hobbyInfo.hobby}_id`],hobby:I.hobbyInfo.hobby};C(e).then((o=>{200===o.statusCode&&(g.value="",k())}))},k=()=>{console.log("props.hobbyInfo=======================",I.hobbyInfo);let o={hobbyId:I.hobbyInfo[`hobby_${I.hobbyInfo.hobby}_id`],hobby:I.hobbyInfo.hobby};T(o).then((o=>{console.log("data666666===",o),200===o.data.code&&(j.value=o.data.data,w.value=o.data.data.length)}))};return a((()=>{e((()=>{k()}))})),(o,a)=>{const e=m,I=y,k=p,F=_;return l(),t("div",{class:"comment"},[s(I,{class:"total"},{default:n((()=>[s(e,null,{default:n((()=>[c("共")])),_:1}),s(e,null,{default:n((()=>[c(d(u(w)),1)])),_:1}),s(e,null,{default:n((()=>[c("条评论")])),_:1})])),_:1}),s(I,{class:"my-comment"},{default:n((()=>[s(k,{class:"avatar",mode:"aspectFit",src:v.hobbyInfo.avatar||""},null,8,["src"]),s(F,{modelValue:u(g),"onUpdate:modelValue":a[0]||(a[0]=o=>i(g)?g.value=o:g=o),type:"text",class:"comment-input",placeholder:"喜欢就给个评论支持一下呗~",onConfirm:x},null,8,["modelValue"])])),_:1}),(l(!0),t(r,null,b(u(j),(a=>(l(),f(I,{class:"other-comment",key:a.id},{default:n((()=>[s(I,null,{default:n((()=>[s(k,{class:"avatar",mode:"aspectFit",src:a.avatar||""},null,8,["src"])])),_:2},1024),s(I,{class:"comment-info"},{default:n((()=>[s(I,{class:"userinfo"},{default:n((()=>[s(e,null,{default:n((()=>[c(d(a.username),1)])),_:2},1024),a.isAuthor?(l(),f(e,{key:0,class:"is-author"},{default:n((()=>[c("作者")])),_:1})):h("v-if",!0)])),_:2},1024),s(I,{class:"comment-content"},{default:n((()=>[s(e,null,{default:n((()=>[c(d(a.comment),1)])),_:2},1024)])),_:2},1024),s(I,null,{default:n((()=>[s(e,null,{default:n((()=>[c(d(o.$filters.commentTime(a.create_time)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])}}}),[["__scopeId","data-v-78a9adac"]]),VideoPlayer:U},onLoad:function(o){console.log("options===",o)},onReady:function(){},setup(e){console.log("props=",e);const l=v(),t=I((()=>l.state.user.userInfo)).value,s=g({poster:"",src:""});let n=o([{content:"https://social-1308251497.cos.ap-guangzhou.myqcloud.com/images/4.jfif"}]);o(0),o("default");let c=o({});let d=o(!1),u=o("关注");let i=o(null);const r=()=>{let o={followId:c.value.user_id};console.log("params===",o),O(o).then((o=>{console.log("data1===",o),200===o.data.code&&(d.value=o.data.isFollow,o.data.isFollow?u.value="已关注":u.value="关注")}))};return a((()=>{console.log("userInfo===",t),(o=>{console.log("obj===================================================================================",o);const{hobby:a}=o;({hobby2:()=>F({title:"狼人杀"}),hobby3:()=>F({title:"剧本杀"}),hobby4:()=>F({title:"登山"}),hobby5:()=>F({title:"旅游"}),hobby6:()=>F({title:"视频"}),hobby7:()=>F({title:"电影"})})[`hobby${a}`]()})(e),(o=>{const{id:a,hobby:e}=o;V({id:a,hobby:e}).then((o=>{console.log("data===",o),200===o.data.code&&(c.value=o.data.data,i.value=q(o.data.data.create_time),console.log("hobbyInfo.value===",c.value),console.log("data.data.data.url===",o.data.data.url),s.poster=o.data.data.url,s.src=o.data.data.video_url,r())}))})({id:e.id,hobby:e.hobby})})),{followText:u,isFlollow:d,following:()=>{if(d.value)return void x({content:"确认不再关注？",success:function(o){if(o.confirm){let o={followId:c.value.user_id};$(o).then((o=>{200===o.data.code&&(u.value="关注",d.value=!1)}))}else o.cancel&&console.log("用户点击取消")}});console.log("userInfo===",t);let o={followId:c.value.user_id};D(o).then((o=>{console.log("data===",o),200===o.data.code?(u.value="已关注",d.value=!0):400===o.data.code&&k({title:o.data.msg,icon:"none",duration:2e3})}))},hobbyInfo:c,info:n,publishDate:i,options:s}}},[["render",function(o,a,e,u,i,r){const b=p,_=w("VideoPlayer"),v=y,I=m,g=w("Comment");return l(),t("div",{class:"hobby-detail"},[h(' <uni-swiper-dot\r\n      :info="info"\r\n      :current="current"\r\n      field="content"\r\n      :mode="mode"\r\n    >\r\n      <swiper class="swiper-box" @change="change">\r\n        <swiper-item v-for="(item, index) in info" :key="index">\r\n          <view class="swiper-item">\r\n            <image :src="item.content" class="image"></image>\r\n          </view>\r\n        </swiper-item>\r\n      </swiper>\r\n    </uni-swiper-dot> '),s(v,{class:"swiper-box"},{default:n((()=>[s(v,{class:"swiper-item"},{default:n((()=>[0===u.hobbyInfo.fileType?(l(),f(b,{key:0,src:u.hobbyInfo.url,class:"image"},null,8,["src"])):h("v-if",!0),1===u.hobbyInfo.fileType?(l(),f(_,{options:{src:u.hobbyInfo.video_url,poster:u.hobbyInfo.url},key:u.hobbyInfo.id},null,8,["options"])):h("v-if",!0)])),_:1})])),_:1}),s(v,{class:"author-wraper"},{default:n((()=>[s(v,{class:"author"},{default:n((()=>[s(v,{class:"author-info"},{default:n((()=>[s(b,{class:"avatar",mode:"aspectFit",src:u.hobbyInfo.avatar||""},null,8,["src"]),s(I,null,{default:n((()=>[c(d(u.hobbyInfo.username||""),1)])),_:1})])),_:1}),s(v,{class:j({follow:!u.isFlollow,active:u.isFlollow}),onClick:u.following},{default:n((()=>[s(I,null,{default:n((()=>[c(d(u.followText),1)])),_:1})])),_:1},8,["class","onClick"])])),_:1})])),_:1}),s(v,{class:"content-wraper"},{default:n((()=>[s(v,{class:"content"},{default:n((()=>[s(v,{class:"title"},{default:n((()=>[c(d(u.hobbyInfo.title),1)])),_:1}),s(v,{class:"main"},{default:n((()=>[c(d(u.hobbyInfo.content),1)])),_:1}),s(v,{class:"publish-date"},{default:n((()=>[s(I,null,{default:n((()=>[c("发布于: ")])),_:1}),s(I,null,{default:n((()=>[c(d(u.publishDate),1)])),_:1})])),_:1})])),_:1})])),_:1}),s(v,{class:"comment-wraper"},{default:n((()=>[u.hobbyInfo.id?(l(),f(g,{hobbyInfo:u.hobbyInfo,key:u.hobbyInfo.id},null,8,["hobbyInfo"])):h("v-if",!0)])),_:1})])}],["__scopeId","data-v-ce86476c"]]);export{A as default};
